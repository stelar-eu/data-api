<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>STELAR | Tools | {{tool.name}}</title>
    <!-- CSS files -->
    {% include 'tabler.html' %}
    <!-- Easy MDE files -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/easymde/dist/easymde.min.css" />
    <script src="https://cdn.jsdelivr.net/npm/easymde/dist/easymde.min.js"></script>

    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="{{ url_for('static', filename='images.js') }}"></script>
    <script src="{{ url_for('static', filename='utils.js') }}"></script>

    <link rel="stylesheet" href="{{ url_for('static', filename='stelar.css') }}">
    <link rel="icon" href="{{ url_for('static', filename='favico.png') }}" type="image/png">
</head>

<body>
    <div class="page">
        <!-- Navbar -->
        {% include 'header.html' %}
        <div class="page-wrapper">
            <!-- Page header -->
            <div class="page-header d-print-none">
                <div class="container-xl">
                    <div class="row g-2 align-items-center">
                        <div class="col-lg">
                            <!-- Page pre-title -->
                            <div class="page-pretitle">
                                Toolkit
                            </div>
                            <h3 class="page-title">
                                <ol class="breadcrumb breadcrumb-arrows">
                                    <li class="breadcrumb-item"><a class="text-secondary"
                                            href="{{ url_for('dashboard_blueprint.tools') }}">Browse & Manage STELAR
                                            Tools</a>
                                        </a>
                                    </li>
                                    <li class="breadcrumb-item active"><a href="#"><span class="text-strong">{{
                                                tool.name }}</span></a> <span id="programming-language" class="ms-1 h2">

                                        </span></li>
                                </ol>
                            </h3>
                        </div>
                        <div class="col-auto ms-auto d-print-none">
                            <div class="d-flex align-items-center">
                                <a class="btn btn-primary ms-auto me-2"
                                    href="{{ url_for('dashboard_blueprint.dataset_relationships', dataset_id=tool.id) }}">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                        stroke-linejoin="round"
                                        class="icon icon-tabler icons-tabler-outline icon-tabler-chart-bubble">
                                        <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                                        <path d="M6 16m-3 0a3 3 0 1 0 6 0a3 3 0 1 0 -6 0" />
                                        <path d="M16 19m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0" />
                                        <path d="M14.5 7.5m-4.5 0a4.5 4.5 0 1 0 9 0a4.5 4.5 0 1 0 -9 0" />
                                    </svg>
                                    Explore Relationships
                                </a>
                                <div class="dropdown">
                                    <button class="btn" data-bs-toggle="dropdown" aria-label="Open Resource Menu">
                                        Actions
                                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                                            viewBox="0 0 24 24" fill="currentColor"
                                            class="m-0 icon icon-tabler icons-tabler-filled icon-tabler-caret-down">
                                            <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                                            <path
                                                d="M18 9c.852 0 1.297 .986 .783 1.623l-.076 .084l-6 6a1 1 0 0 1 -1.32 .083l-.094 -.083l-6 -6l-.083 -.094l-.054 -.077l-.054 -.096l-.017 -.036l-.027 -.067l-.032 -.108l-.01 -.053l-.01 -.06l-.004 -.057v-.118l.005 -.058l.009 -.06l.01 -.052l.032 -.108l.027 -.067l.07 -.132l.065 -.09l.073 -.081l.094 -.083l.077 -.054l.096 -.054l.036 -.017l.067 -.027l.108 -.032l.053 -.01l.06 -.01l.057 -.004l12.059 -.002z">
                                            </path>
                                        </svg>
                                    </button>
                                    <div class="dropdown-menu dropdown-menu-end dropdown-menu-arrow ">
                                        <a class="dropdown-item view-dataset-btn cursor-pointer" data-bs-toggle="modal"
                                            data-bs-target="#modal-edit-tool">
                                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                                                viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                                                stroke-linecap="round" stroke-linejoin="round"
                                                class="me-2 icon icon-tabler icons-tabler-outline icon-tabler-settings">
                                                <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                                                <path
                                                    d="M10.325 4.317c.426 -1.756 2.924 -1.756 3.35 0a1.724 1.724 0 0 0 2.573 1.066c1.543 -.94 3.31 .826 2.37 2.37a1.724 1.724 0 0 0 1.065 2.572c1.756 .426 1.756 2.924 0 3.35a1.724 1.724 0 0 0 -1.066 2.573c.94 1.543 -.826 3.31 -2.37 2.37a1.724 1.724 0 0 0 -2.572 1.065c-.426 1.756 -2.924 1.756 -3.35 0a1.724 1.724 0 0 0 -2.573 -1.066c-1.543 .94 -3.31 -.826 -2.37 -2.37a1.724 1.724 0 0 0 -1.065 -2.572c-1.756 -.426 -1.756 -2.924 0 -3.35a1.724 1.724 0 0 0 1.066 -2.573c-.94 -1.543 .826 -3.31 2.37 -2.37c1 .608 2.296 .07 2.572 -1.065z">
                                                </path>
                                                <path d="M9 12a3 3 0 1 0 6 0a3 3 0 0 0 -6 0"></path>
                                            </svg>
                                            Manage</a>
                                        <div class="dropdown-divider"></div>
                                        <a data-bs-toggle="modal" data-bs-target="#modal-delete-tool"
                                            class="text-danger cursor-pointer dropdown-item del-dataset-btn">
                                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                                                viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                                                stroke-linecap="round" stroke-linejoin="round"
                                                class="me-2 text-danger icon icon-tabler icons-tabler-outline icon-tabler-trash">
                                                <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                                                <path d="M4 7l16 0"></path>
                                                <path d="M10 11l0 6"></path>
                                                <path d="M14 11l0 6"></path>
                                                <path d="M5 7l1 12a2 2 0 0 0 2 2h8a2 2 0 0 0 2 -2l1 -12"></path>
                                                <path d="M9 7v-3a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v3"></path>
                                            </svg>
                                            Delete</a>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-lg-12">
                            <div class="text-secondary text-sm h4 m-0">
                                <div class="mt-1 list-inline list-inline-dots mb-0 text-secondary d-sm-block d-none">
                                    <a href="{{url_for('dashboard_blueprint.organization', organization_id=tool.organization.id)}}"
                                        target="_blank" class="text-blue card-link list-inline-item" title="Belongs to">
                                        <svg xmlns="http://www.w3.org/2000/svg"
                                            class="icon icon-tabler icon-tabler-building-bank" width="44" height="44"
                                            viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" fill="none"
                                            stroke-linecap="round" stroke-linejoin="round">
                                            <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                                            <path d="M3 21l18 0" />
                                            <path d="M3 10l18 0" />
                                            <path d="M5 6l7 -3l7 3" />
                                            <path d="M4 10l0 11" />
                                            <path d="M20 10l0 11" />
                                            <path d="M8 14l0 3" />
                                            <path d="M12 14l0 3" />
                                            <path d="M16 14l0 3" />
                                        </svg>
                                        {{ tool.organization.title }}
                                    </a>
                                    <div class="list-inline-item" title="Created by">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                                            viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"
                                            stroke-linecap="round" stroke-linejoin="round"
                                            class="icon icon-tabler icons-tabler-outline icon-tabler-user">
                                            <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                                            <path d="M8 7a4 4 0 1 0 8 0a4 4 0 0 0 -8 0" />
                                            <path d="M6 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2" />
                                        </svg>
                                        {{ tool.get("author") }}
                                    </div>

                                    {% if tool.license_id %}
                                    <div class="list-inline-item" id="tool-license">

                                    </div>
                                    {% endif %}
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="page-body">
                <div class="container-xl">
                    <div class="row row-cards">
                        <div class="col-lg-8">
                            <div class="card card-lg ">
                                <div class="card-header">
                                    <ul class="nav nav-tabs card-header-tabs" data-bs-toggle="tabs" role="tablist">
                                        <li class="nav-item" role="presentation">
                                            <a href="#tabs-docs-1" class="nav-link active h3 strong"
                                                data-bs-toggle="tab" aria-selected="true" role="tab">
                                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                                                    viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                                    stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                                                    class="me-2 icon icon-tabler icons-tabler-outline icon-tabler-script">
                                                    <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                                                    <path
                                                        d="M17 20h-11a3 3 0 0 1 0 -6h11a3 3 0 0 0 0 6h1a3 3 0 0 0 3 -3v-11a2 2 0 0 0 -2 -2h-10a2 2 0 0 0 -2 2v8" />
                                                </svg>
                                                Documentation
                                            </a>
                                        </li>
                                        <li class="nav-item" role="presentation">
                                            <a href="#tabs-io-1" class="nav-link h3 strong" data-bs-toggle="tab"
                                                aria-selected="false" role="tab" tabindex="-1">
                                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                                                    viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                                    stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                                                    class="me-2 icon icon-tabler icons-tabler-outline icon-tabler-arrows-diff">
                                                    <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                                                    <path d="M11 16h10" />
                                                    <path d="M11 16l4 4" />
                                                    <path d="M11 16l4 -4" />
                                                    <path d="M13 8h-10" />
                                                    <path d="M13 8l-4 4" />
                                                    <path d="M13 8l-4 -4" />
                                                </svg>
                                                I/O & Parameters</a>
                                        </li>
                                        <li class="nav-item" role="presentation">
                                            <a href="#tabs-profiles-1" class="nav-link h3 strong" data-bs-toggle="tab"
                                                aria-selected="false" role="tab" tabindex="-1">
                                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                                                    viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                                    stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                                                    class="me-2 icon icon-tabler icons-tabler-outline icon-tabler-cpu">
                                                    <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                                                    <path
                                                        d="M5 5m0 1a1 1 0 0 1 1 -1h12a1 1 0 0 1 1 1v12a1 1 0 0 1 -1 1h-12a1 1 0 0 1 -1 -1z" />
                                                    <path d="M9 9h6v6h-6z" />
                                                    <path d="M3 10h2" />
                                                    <path d="M3 14h2" />
                                                    <path d="M10 3v2" />
                                                    <path d="M14 3v2" />
                                                    <path d="M21 10h-2" />
                                                    <path d="M21 14h-2" />
                                                    <path d="M14 21v-2" />
                                                    <path d="M10 21v-2" />
                                                </svg>
                                                Execution Profiles</a>
                                        </li>
                                        <!-- <li class="nav-item" role="presentation">
                                                <a href="#tabs-processes-1" class="nav-link" data-bs-toggle="tab" aria-selected="false" role="tab"
                                                tabindex="-1">Processes</a>
                                            </li> -->
                                    </ul>
                                </div>
                                <div class="card-body p-0">
                                    <div class="tab-content">
                                        <div class="tab-pane active show" id="tabs-docs-1" role="tabpanel">
                                            <div class="d-flex p-2 mt-3 me-4 card-body pb-2">
                                                <div class="ms-auto d-flex align-items-center"
                                                    id="documentation-actions">
                                                    {% if tool.git_repo and tool.git_user %}
                                                    <button class="btn" onclick="syncDocumentationFromGithub()"
                                                        id="sync-markdown-btn">
                                                        <span class="icon social social-app-github"></span>
                                                        Sync from GitHub
                                                    </button>
                                                    {% endif %}
                                                    <button class="ms-2 btn" onclick="openMarkdownEditor()"
                                                        id="edit-markdown-btn">
                                                        <svg xmlns=" http://www.w3.org/2000/svg" width="24" height="24"
                                                            viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                                            stroke-width="2" stroke-linecap="round"
                                                            stroke-linejoin="round"
                                                            class="icon me-1 icon-tabler icons-tabler-outline icon-tabler-pencil">
                                                            <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                                                            <path
                                                                d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
                                                            <path d="M13.5 6.5l4 4" />
                                                        </svg>
                                                        Edit
                                                    </button>
                                                    <button class="btn ms-2" onclick="saveEditedDocumentation()"
                                                        id="save-markdown-btn" style="display: none;"><svg
                                                            xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                                                            viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                                            stroke-width="2" stroke-linecap="round"
                                                            stroke-linejoin="round"
                                                            class="me-2 icon icon-tabler icons-tabler-outline icon-tabler-device-floppy">
                                                            <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                                                            <path
                                                                d="M6 4h10l4 4v10a2 2 0 0 1 -2 2h-12a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2" />
                                                            <path d="M12 14m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0" />
                                                            <path d="M14 4l0 4l-6 0l0 -4" />
                                                        </svg>Save</button>
                                                    <button class="btn ms-2" onclick="closeMarkdownEditor()"
                                                        id="close-editor-btn" style="display: none;">Close</button>
                                                </div>
                                            </div>
                                            <div class="card-body markdown p-5 pt-0 border-top-0"
                                                id="documentation-content">
                                                {{ tool.readme | safe }}
                                            </div>
                                        </div>
                                        <div class="tab-pane" id="tabs-io-1" role="tabpanel">
                                            <div class="card-body p-5">
                                                <div class="d-flex align-items-center mb-4">
                                                    <h2 class="m-0">Inputs</h2>
                                                    <a class="ms-auto cursor-pointer btn btn-outline-primary"
                                                        data-bs-toggle="modal" data-bs-target="#modal-new-input">
                                                        <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24"
                                                            height="24" viewBox="0 0 24 24" stroke-width="2"
                                                            stroke="currentColor" fill="none" stroke-linecap="round"
                                                            stroke-linejoin="round">
                                                            <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                                                            <path d="M12 5l0 14"></path>
                                                            <path d="M5 12l14 0"></path>
                                                        </svg>
                                                        Define Input
                                                    </a>
                                                </div>

                                                <table class="table table-bordered m-0">
                                                    <thead>
                                                        <tr>
                                                            <th class="w-25">Input Name</th>
                                                            <th class="w-50">Description</th>
                                                            <th class="text-center">Format</th>
                                                            <th class="text-center w-1">Required</th>
                                                            <th class="text-center w-1">Actions</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody id="inputs-list">

                                                    </tbody>
                                                </table>

                                                <div class="d-flex align-items-center mt-6 mb-4">
                                                    <h2 class="m-0">Outputs</h2>
                                                    <a class="ms-auto cursor-pointer btn btn-outline-primary"
                                                        data-bs-toggle="modal" data-bs-target="#modal-new-output">
                                                        <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24"
                                                            height="24" viewBox="0 0 24 24" stroke-width="2"
                                                            stroke="currentColor" fill="none" stroke-linecap="round"
                                                            stroke-linejoin="round">
                                                            <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                                                            <path d="M12 5l0 14"></path>
                                                            <path d="M5 12l14 0"></path>
                                                        </svg>
                                                        Define Output
                                                    </a>
                                                </div>
                                                <table class="table table-bordered m-0">
                                                    <thead>
                                                        <tr>
                                                            <th class="w-25">Output Name</th>
                                                            <th class="w-50">Description</th>
                                                            <th class="text-center">Format</th>
                                                            <th class="text-center w-1">Actions</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody id="outputs-list">

                                                    </tbody>
                                                </table>

                                                <div class="d-flex align-items-center mt-6 mb-4">
                                                    <h2 class="m-0">Parameters</h2>
                                                    <a class="ms-auto cursor-pointer btn btn-outline-primary"
                                                        data-bs-toggle="modal" data-bs-target="#modal-new-parameter">
                                                        <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24"
                                                            height="24" viewBox="0 0 24 24" stroke-width="2"
                                                            stroke="currentColor" fill="none" stroke-linecap="round"
                                                            stroke-linejoin="round">
                                                            <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                                                            <path d="M12 5l0 14"></path>
                                                            <path d="M5 12l14 0"></path>
                                                        </svg>
                                                        Define Parameter
                                                    </a>
                                                </div>
                                                <table class="table table-bordered m-0">
                                                    <thead>
                                                        <tr>
                                                            <th class="w-25">Name</th>
                                                            <th class="w-50">Value</th>
                                                            <th class="text-center w-25">Description</th>
                                                            <th class="text-center w-1">Required</th>
                                                            <th class="text-center w-1">Actions</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody id="parameters-list">

                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>
                                        <div class="tab-pane" id="tabs-profiles-1" role="tabpanel">
                                            <div class="card-body p-5">
                                                <div class="d-flex">
                                                    <h2>Execution Profiles</h2>
                                                    <div class="ms-auto">
                                                        <button class="btn btn-outline-primary mb-1" onclick="addProfile()" id="add-profile-btn">
                                                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                                                                viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                                                stroke-width="2" stroke-linecap="round"
                                                                stroke-linejoin="round"
                                                                class="icon icon-tabler icons-tabler-outline icon-tabler-plus">
                                                                <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                                                                <path d="M12 5l0 14"></path>
                                                                <path d="M5 12l14 0"></path>
                                                            </svg>
                                                            Add Profile
                                                        </button>
                                                    </div>
                                                </div>
                                                <div class="text-muted mb-3">Execution profiles define the logic and
                                                    rules for configuring and managing tasks or operations based on
                                                    provided inputs, such as tools and images, ensuring appropriate
                                                    behavior and resource allocation for different scenarios.</div>
                                                <div id="profiles-container" class="row row-cards g-3">
                                                    
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-lg-4">
                            <div class="card mb-2" style="max-height: 22rem;">
                                <div class="card-header d-flex align-items-center">
                                    <div class="me-3">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                                            viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                                            stroke-linecap="round" stroke-linejoin="round"
                                            class="icon icon-tabler icons-tabler-outline icon-tabler-brand-docker">
                                            <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                                            <path
                                                d="M22 12.54c-1.804 -.345 -2.701 -1.08 -3.523 -2.94c-.487 .696 -1.102 1.568 -.92 2.4c.028 .238 -.32 1 -.557 1h-14c0 5.208 3.164 7 6.196 7c4.124 .022 7.828 -1.376 9.854 -5c1.146 -.101 2.296 -1.505 2.95 -2.46z" />
                                            <path d="M5 10h3v3h-3z" />
                                            <path d="M8 10h3v3h-3z" />
                                            <path d="M11 10h3v3h-3z" />
                                            <path d="M8 7h3v3h-3z" />
                                            <path d="M11 7h3v3h-3z" />
                                            <path d="M11 4h3v3h-3z" />
                                            <path d="M4.571 18c1.5 0 2.047 -.074 2.958 -.78" />
                                            <path d="M10 16l0 .01" />
                                        </svg>
                                    </div>
                                    <div>
                                        <h3 class="m-0">
                                            {{ tool.repository }}
                                        </h3>
                                        <small class="text-secondary">
                                            Docker images pushed in the local registry
                                        </small>
                                    </div>
                                    <a class="ms-auto cursor-pointer" data-bs-toggle="modal"
                                        data-bs-target="#docker-push-modal"><svg xmlns="http://www.w3.org/2000/svg"
                                            width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                            stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                                            class="text-primary icon icon-tabler icons-tabler-outline icon-tabler-info-circle">
                                            <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                                            <path d="M3 12a9 9 0 1 0 18 0a9 9 0 0 0 -18 0" />
                                            <path d="M12 9h.01" />
                                            <path d="M11 12h1v4h1" />
                                        </svg>
                                    </a>
                                    <a onclick="fetchToolImages(true)" class="ms-auto cursor-pointer"><svg
                                            xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                                            viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                                            stroke-linecap="round" stroke-linejoin="round"
                                            class="text-primary icon icon-tabler icons-tabler-outline icon-tabler-refresh">
                                            <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                                            <path d="M20 11a8.1 8.1 0 0 0 -15.5 -2m-.5 -4v4h4" />
                                            <path d="M4 13a8.1 8.1 0 0 0 15.5 2m.5 4v-4h-4" />
                                        </svg>
                                    </a>
                                </div>
                                <div class="card-body card-body-scrollable card-body-scrollable-shadow">
                                    <div class="ms-1">
                                        <div class="divide-y" id="tool-images">
                                            <div class="row">
                                                <div class="text-secondary placeholder-glow">
                                                    <div class="placeholder placeholder-xs col-9"></div>
                                                    <div class="placeholder placeholder-xs col-7"></div>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="text-secondary placeholder-glow">
                                                    <div class="placeholder placeholder-xs col-9"></div>
                                                    <div class="placeholder placeholder-xs col-7"></div>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="text-secondary placeholder-glow">
                                                    <div class="placeholder placeholder-xs col-9"></div>
                                                    <div class="placeholder placeholder-xs col-7"></div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            {% if tool.git_repo and tool.git_user %}
                            <div class="card mb-2" style="max-height: 25rem">
                                <div class="card-header d-flex align-items-center">
                                    <div class="me-3">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                                            viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                                            stroke-linecap="round" stroke-linejoin="round"
                                            class="icon icon-tabler icons-tabler-outline icon-tabler-brand-github">
                                            <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                                            <path
                                                d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5" />
                                        </svg>
                                    </div>
                                    <div>
                                        <h3 class="m-0">
                                            <a href="{{ tool.git_repository }}" target="_blank">
                                                {{ tool.git_user }}/{{ tool.git_repo }}
                                            </a>
                                        </h3>
                                        <small class="text-secondary">
                                            Latest commits under the <kbd>main</kbd> branch
                                        </small>
                                    </div>
                                    <a onclick="refreshCommitList()" class="ms-auto cursor-pointer"><svg
                                            xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                                            viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                                            stroke-linecap="round" stroke-linejoin="round"
                                            class="text-primary icon icon-tabler icons-tabler-outline icon-tabler-refresh">
                                            <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                                            <path d="M20 11a8.1 8.1 0 0 0 -15.5 -2m-.5 -4v4h4" />
                                            <path d="M4 13a8.1 8.1 0 0 0 15.5 2m.5 4v-4h-4" />
                                        </svg>
                                    </a>
                                </div>
                                <div class="card-body card-body-scrollable card-body-scrollable-shadow">
                                    <div class="mt-3 ms-1">
                                        <ul class="steps steps-vertical" id="git-commits">
                                            <li class="step-item">
                                                <div class="text-secondary placeholder-glow">
                                                    <div class="placeholder placeholder-xs col-9"></div>
                                                    <div class="placeholder placeholder-xs col-7"></div>
                                                </div>
                                            </li>
                                            <li class="step-item">
                                                <div class="text-secondary placeholder-glow">
                                                    <div class="placeholder placeholder-xs col-9"></div>
                                                    <div class="placeholder placeholder-xs col-7"></div>
                                                </div>
                                            </li>
                                            <li class="step-item">

                                                <div class="text-secondary placeholder-glow">
                                                    <div class="placeholder placeholder-xs col-9"></div>
                                                    <div class="placeholder placeholder-xs col-7"></div>
                                                </div>
                                            </li>
                                            <li class="step-item">
                                                <div class="text-secondary placeholder-glow">
                                                    <div class="placeholder placeholder-xs col-9"></div>
                                                    <div class="placeholder placeholder-xs col-7"></div>
                                                </div>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                            {% endif %}
                            <div class="card mb-2">
                                <div class="card-body">
                                    <div class="d-flex align-items-center justify-content-between">
                                        <h5 class="card-title mb-0">Tags</h5>
                                        <a class="cursor-pointer" title="Update Tags" data-bs-toggle="tooltip"
                                            onclick="updateTags()" data-bs-placement="bottom" id="update-tags-icon">
                                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                                                viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                                                stroke-linecap="round" stroke-linejoin="round"
                                                class="text-primary ms-2 icon icon-tabler icons-tabler-outline icon-tabler-cloud-up">
                                                <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                                                <path
                                                    d="M12 18.004h-5.343c-2.572 -.004 -4.657 -2.011 -4.657 -4.487c0 -2.475 2.085 -4.482 4.657 -4.482c.393 -1.762 1.794 -3.2 3.675 -3.773c1.88 -.572 3.956 -.193 5.444 1c1.488 1.19 2.162 3.007 1.77 4.769h.99c1.38 0 2.57 .811 3.128 1.986" />
                                                <path d="M19 22v-6" />
                                                <path d="M22 19l-3 -3l-3 3" />
                                            </svg>
                                            <span class="text-primary">Update</span>
                                        </a>
                                    </div>
                                    <div class="mb-2">
                                        <input type="hidden" name="packageTags" id="hiddenTagsInput"
                                            value="{{ tool.get('tags') | join(',') }}" />
                                        <div class="col-lg-12 mt-3">
                                            <div class="mb-3">
                                                <input type="text" id="tagInput" class="form-control"
                                                    placeholder="Type a tag and press enter" required>
                                                <div class="col tags-list mt-3" id="tagsContainer">
                                                    {% for tag in tool.get('tags') %}
                                                    <span class="tag me-2 mb-2">
                                                        {{ tag }}
                                                        <a class="cursor-pointer btn-close ms-1" data-index="1"></a>
                                                    </span>
                                                    {% endfor %}
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>


                <!-- Modals -->
                <div class="modal modal-blur fade" id="docker-push-modal" tabindex="-1" style="display: none;"
                    aria-hidden="true">
                    <div class="modal-dialog modal-1 modal-dialog-centered" role="document">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h5 class="modal-title">Push an Image</h5>
                                <button type="button" class="btn-close" data-bs-dismiss="modal"
                                    aria-label="Close"></button>
                            </div>
                            <div class="modal-body">
                                <p class="text-secondary mb-1">
                                    You may push a Docker image to the local registry using the command:</p>

                                <div class="text-center">
                                    <kbd id="docker-command">docker push {{ tool.repository
                                        }}:&lt;tag-name&gt;</kbd>
                                </div>
                                <p class="text-secondary mt-4">Adjust the <kbd>&lt;tag-name&gt;</kbd> to define the
                                    desired version.</p>
                                </p>
                                <p class="text-secondary my-1">
                                    Issue docker-cli credentials through
                                    <a href="{{url_for('dashboard_blueprint.settings')}}" target='_blank'>Account
                                        Settings</a>. Tool images should adhere to the <a
                                        href="https://github.com/stelar-eu/klms-tool-template" target="_blank">KLMS
                                        Tool Template</a>
                                </p>
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn me-auto" data-bs-dismiss="modal">Close</button>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="modal modal-blur fade" id="image-layer-modal" tabindex="-1" style="display: none;"
                    aria-hidden="true">
                    <div class="modal-dialog modal-lg modal-dialog-centered" role="document">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h5 class="modal-title">Image Layers</h5>
                                <button type="button" class="btn-close" data-bs-dismiss="modal"
                                    aria-label="Close"></button>
                            </div>
                            <div class="modal-body">
                                <div class=" card-body card-body-scrollable card-body-scrollable-shadow">
                                    <div class="mt-3 ms-1">
                                        <ul class="steps steps-vertical" id="image-layers">


                                        </ul>
                                    </div>
                                </div>
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn me-auto" data-bs-dismiss="modal">Close</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal modal-blur fade" id="modal-edit-tool" tabindex="-1" role="dialog" aria-hidden="true">
                <div class="modal-dialog modal-lg modal-dialog-centered" role="document">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title">Manage Tool</h5>
                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                        </div>
                        <div class="modal-body">

                            <div class="row">
                                <div class="col-lg-8">
                                    <div class="mb-3">
                                        <label class="form-label">Name</label>
                                        <input type="text" class="form-control" name="example-disabled-input"
                                            id="package-name-input" placeholder="Tool Name" readonly
                                            value="{{ tool.get('name') }}" disabled>
                                        <small class="form-hint">
                                            <p>
                                                The Package ID is a unique identifier for the tool.
                                            </p>
                                        </small>
                                    </div>
                                </div>
                                <div class="col-lg-4">
                                    <div class="mb-3">
                                        <label class="form-label">Tool Category</label>
                                        <select class="form-select" id="tool-category" name="tool-category">
                                            <option value="discovery" {% if tool.get('category')=='discovery'
                                                %}selected{% endif %}>Discovery</option>
                                            <option value="interlinking" {% if tool.get('category')=='interlinking'
                                                %}selected{% endif %}>Interlinking</option>
                                            <option value="annotation" {% if tool.get('category')=='annotation'
                                                %}selected{% endif %}>Annotation</option>
                                            <option value="other" {% if not tool.get('category') or tool.get('category')
                                                not in ['discovery', 'interlinking' , 'annotation' ] %}selected{% endif
                                                %}>Other</option>
                                        </select>
                                    </div>
                                </div>
                                <small class="form-hint">
                                    <p>
                                        After creating the tool, the documentation and other metadata may be updated
                                        in the tool's page.
                                    </p>
                                </small>
                            </div>
                            <div class="mb-3">
                                <label class="form-label">GitHub Repository URL</label>
                                <div class="input-group input-group-flat">
                                    <span class="input-group-text"> https://github.com/</span>
                                    <input type="text" class="form-control ps-0"
                                        value="{{ tool.get('git_repository').replace('https://github.com/','').replace('http://github.com/','') }}"
                                        autocomplete="off" id="git-repo" name="git-repo">
                                </div>
                                <small class="form-hint">
                                    <p>
                                        The URL of the GitHub repository where the source code is stored. It is used to
                                        fetch the
                                        documentation and latest commits.
                                    </p>
                                </small>
                            </div>
                            <div class="mb-3">
                                <label class="form-label">Software License</label>
                                <select class="form-select" id="license-id" name="tool-license">

                                </select>
                            </div>

                            <div class="mb-3">
                                <label class="form-label">Visibility</label>
                                <div class="form-selectgroup-boxes row mb-1">
                                    <div class="col-lg-6 text-success mb-2">
                                        <label class="form-selectgroup-item">
                                            <input type="radio" name="package-visibility" value="public"
                                                class="form-selectgroup-input" {% if not tool.get('private') %}checked{%
                                                endif %}>
                                            <span class="form-selectgroup-label d-flex align-items-center p-3">
                                                <span class="me-3">
                                                    <span class="form-selectgroup-check"></span>
                                                </span>
                                                <span class="form-selectgroup-label-content">
                                                    <span class="form-selectgroup-title strong mb-1">Public</span>
                                                    <span class="d-block text-secondary">Accessible to all users
                                                        registered in the KLMS</span>
                                                </span>
                                            </span>
                                        </label>
                                    </div>
                                    <div class="col-lg-6 text-danger mb-2">
                                        <label class="form-selectgroup-item">
                                            <input type="radio" name="package-visibility" value="private"
                                                class="form-selectgroup-input" {% if tool.get('private') %}checked{%
                                                endif %}>
                                            <span class="form-selectgroup-label d-flex align-items-center p-3">
                                                <span class="me-3">
                                                    <span class="form-selectgroup-check"></span>
                                                </span>
                                                <span class="form-selectgroup-label-content">
                                                    <span class="form-selectgroup-title strong mb-1">Private</span>
                                                    <span class="d-block text-secondary">Accessible only to members of
                                                        the organization that
                                                        owns the package</span>
                                                </span>
                                            </span>
                                        </label>
                                    </div>
                                </div>
                            </div>
                            <label class="form-label">Package ID</label>
                            <input type="text" class="form-control" name="example-disabled-input" id="package-id-input"
                                placeholder="Package-ID" readonly value="{{ tool.get('id') }}" disabled>
                            <small class="form-hint">
                                <p>
                                    The Package ID is a unique identifier for the tool.
                                </p>
                            </small>
                        </div>
                        <div class="modal-footer" id="manage-package-footer">
                            <button type="button" class="btn btn-outline-primary"
                                onclick="copyText('package-id-input', 'manage-package-footer')">
                                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copy"
                                    width="44" height="44" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"
                                    fill="none" stroke-linecap="round" stroke-linejoin="round">
                                    <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                                    <path
                                        d="M7 7m0 2.667a2.667 2.667 0 0 1 2.667 -2.667h8.666a2.667 2.667 0 0 1 2.667 2.667v8.666a2.667 2.667 0 0 1 -2.667 2.667h-8.666a2.667 2.667 0 0 1 -2.667 -2.667z" />
                                    <path
                                        d="M4.012 16.737a2.005 2.005 0 0 1 -1.012 -1.737v-10c0 -1.1 .9 -2 2 -2h10c.75 0 1.158 .385 1.5 1" />
                                </svg>
                                Copy ID</button>
                            <button class="btn btn-primary" id="update-package-btn"
                                onclick="updateTool()">Update</button>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal modal-blur fade" id="modal-delete-tool" tabindex="-1" role="dialog" aria-hidden="true">
                <div class="modal-dialog modal-sm modal-dialog-centered" role="document">
                    <div class="modal-content">
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                        <div class="modal-status bg-danger"></div>
                        <div class="modal-body text-center py-4">
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon mb-2 text-danger icon-lg" width="24"
                                height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none"
                                stroke-linecap="round" stroke-linejoin="round">
                                <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                                <path
                                    d="M10.24 3.957l-8.422 14.06a1.989 1.989 0 0 0 1.7 2.983h16.845a1.989 1.989 0 0 0 1.7 -2.983l-8.423 -14.06a1.989 1.989 0 0 0 -3.4 0z">
                                </path>
                                <path d="M12 9v4"></path>
                                <path d="M12 17h.01"></path>
                            </svg>
                            <h3>Are you sure?</h3>
                            <div class="text-secondary">Do you really want to remove <strong>{{tool.name}}</strong>.
                                This action is irreversible.</div>
                        </div>
                        <div class="modal-footer">
                            <div class="w-100">
                                <div class="row">
                                    <div class="col"><a href="#" class="btn w-100" data-bs-dismiss="modal">
                                            Cancel
                                        </a></div>
                                    <div class="col"><a class="btn btn-danger w-100" data-bs-dismiss="modal"
                                            onclick="deleteTool()">
                                            Delete Tool
                                        </a></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="modal modal-blur fade" id="modal-new-input" tabindex="-1" style="display: none;"
                aria-hidden="true">
                <div class="modal-dialog modal-dialog-centered" role="document">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title">Define New Input</h5>
                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                        </div>
                        <div class="modal-body">
                            <div class="mb-3">
                                <label class="form-label">Name</label>
                                <div class="input-group">
                                    <input type="text" class="form-control" id="new-input-name" name="new-input-name"
                                        placeholder="input_name">
                                </div>
                            </div>
                            <div class="mb-3">
                                <label class="form-label">Description</label>
                                <div class="input-group">
                                    <textarea type="text" rows=3 class="form-control" id="new-input-description"
                                        name="new-input-description"
                                        placeholder="A descriptive explanation of the input">
                                    </textarea>
                                </div>
                            </div>
                            <div class="mb-3">
                                <label class="form-label">Required to Specify</label>
                                <label class="form-check form-switch form-switch-3">
                                    <input class="form-check-input" type="checkbox" id="new-input-required" checked="">
                                    <span class="form-check-label">Required</span>
                                </label>
                            </div>
                            <div class="mb-3">
                                <label class="form-label">Format</label>
                                <div class="input-group">
                                    <select class="form-select" id="new-input-format" name="new-input-format">
                                        <option value="csv">CSV</option>
                                        <option value="tif">TIF</option>
                                        <option value="shp">SHP</option>
                                        <option value="ras">RAS</option>
                                        <option value="rhd">RHD</option>
                                        <option value="xlsx">XLSX</option>
                                        <option value="json">JSON</option>
                                        <option value="xml">XML</option>
                                        <option value="yaml">YAML</option>
                                        <option value="geojson">GeoJSON</option>
                                        <option value="prq">PRQ</option>
                                        <option value="avro">AVRO</option>
                                        <option value="orc">ORC</option>
                                        <option value="pdf">PDF</option>
                                        <option value="txt">TXT</option>
                                        <option value="zip">ZIP</option>
                                        <option value="tar">TAR</option>
                                        <option value="html">HTML</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        <div class="modal-footer" id="new-input-footer">
                            <button type="button" class="btn btn-primary ms-auto disabled" onclick="createNewInput()">
                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                                    fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                    stroke-linejoin="round" class="icon icon-2">
                                    <path d="M12 5l0 14"></path>
                                    <path d="M5 12l14 0"></path>
                                </svg>
                                Create Definition</button>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal modal-blur fade" id="modal-new-output" tabindex="-1" style="display: none;"
                aria-hidden="true">
                <div class="modal-dialog modal-dialog-centered" role="document">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title">Define New Output</h5>
                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                        </div>
                        <div class="modal-body">
                            <div class="mb-3">
                                <label class="form-label">Name</label>
                                <div class="input-group">
                                    <input type="text" class="form-control" id="new-output-name" name="new-output-name"
                                        placeholder="output_name">
                                </div>
                            </div>
                            <div class="mb-3">
                                <label class="form-label">Description</label>
                                <div class="input-group">
                                    <textarea type="text" rows=3 class="form-control" id="new-output-description"
                                        name="new-output-description"
                                        placeholder="A descriptive explanation of the input">
                                    </textarea>
                                </div>
                            </div>
                            <div class="mb-3">
                                <label class="form-label">Format</label>
                                <div class="input-group">
                                    <select class="form-select" id="new-output-format" name="new-output-format">
                                        <option value="csv">CSV</option>
                                        <option value="tif">TIF</option>
                                        <option value="shp">SHP</option>
                                        <option value="ras">RAS</option>
                                        <option value="rhd">RHD</option>
                                        <option value="xlsx">XLSX</option>
                                        <option value="json">JSON</option>
                                        <option value="xml">XML</option>
                                        <option value="yaml">YAML</option>
                                        <option value="geojson">GeoJSON</option>
                                        <option value="prq">PRQ</option>
                                        <option value="avro">AVRO</option>
                                        <option value="orc">ORC</option>
                                        <option value="pdf">PDF</option>
                                        <option value="txt">TXT</option>
                                        <option value="zip">ZIP</option>
                                        <option value="tar">TAR</option>
                                        <option value="html">HTML</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        <div class="modal-footer" id="new-output-footer">
                            <button type="button" class="btn btn-primary ms-auto disabled" onclick="createNewOutput()">
                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                                    fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                    stroke-linejoin="round" class="icon icon-2">
                                    <path d="M12 5l0 14"></path>
                                    <path d="M5 12l14 0"></path>
                                </svg>
                                Create Definition</button>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal modal-blur fade" id="modal-new-parameter" tabindex="-1" style="display: none;"
                aria-hidden="true">
                <div class="modal-dialog modal-dialog-centered" role="document">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title">Define New Parameter</h5>
                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                        </div>
                        <div class="modal-body">
                            <div class="mb-3">
                                <label class="form-label">Name</label>
                                <div class="input-group">
                                    <input type="text" class="form-control" id="new-parameter-name"
                                        name="new-parameter-name" placeholder="parameter_name">
                                </div>
                            </div>
                            <div class="mb-3">
                                <label class="form-label">Value</label>
                                <div class="input-group">
                                    <textarea type="text" rows=3 class="form-control" id="new-parameter-value"
                                        name="new-output-value">
                                    </textarea>
                                </div>
                            </div>
                            <div class="mb-3">
                                <label class="form-label">Description</label>
                                <div class="input-group">
                                    <textarea type="text" rows=3 class="form-control" id="new-parameter-description"
                                        name="new-output-description">
                                    </textarea>
                                </div>
                            </div>
                            <div class="mb-3">
                                <label class="form-label">Required to Specify</label>
                                <label class="form-check form-switch form-switch-3">
                                    <input class="form-check-input" type="checkbox" id="new-parameter-required"
                                        checked="">
                                    <span class="form-check-label">Required</span>
                                </label>
                            </div>
                        </div>
                        <div class="modal-footer" id="new-parameter-footer">
                            <button type="button" class="btn btn-primary ms-auto disabled"
                                onclick="createNewParameter()">
                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                                    fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                    stroke-linejoin="round" class="icon icon-2">
                                    <path d="M12 5l0 14"></path>
                                    <path d="M5 12l14 0"></path>
                                </svg>
                                Create Definition</button>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal modal-blur fade" id="new-profile-modal" tabindex="-1" role="dialog" aria-modal="true" style="display: none;">
                <div class="modal-dialog modal-lg modal-dialog-centered" role="document">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title">New Execution Profile</h5>
                            <button type="button" class="btn-close" data-bs-dismiss="modal"
                                aria-label="Close"></button>
                        </div>
                        <div class="modal-body">
                            <div class="mb-3">
                                <div class="row">
                                    <div class="col-lg-7">
                                        <label class="form-label">Name</label>
                                        <input type="text" class="form-control" name="name" placeholder="the-profile"
                                            id="new-profile-name">
                                    </div>
                                    <div class="col-lg-5">
                                        <label class="form-label">
                                            <svg xmlns="http://www.w3.org/2000/svg"
                                                width="24" height="24"
                                                viewBox="0 0 24 24" fill="none"
                                                stroke="currentColor"
                                                stroke-width="2"
                                                stroke-linecap="round"
                                                stroke-linejoin="round"
                                                class="m-0 icon icon-tabler icons-tabler-outline icon-tabler-brand-docker">
                                                <path stroke="none"
                                                    d="M0 0h24v24H0z"
                                                    fill="none" />
                                                <path
                                                    d="M22 12.54c-1.804 -.345 -2.701 -1.08 -3.523 -2.94c-.487 .696 -1.102 1.568 -.92 2.4c.028 .238 -.32 1 -.557 1h-14c0 5.208 3.164 7 6.196 7c4.124 .022 7.828 -1.376 9.854 -5c1.146 -.101 2.296 -1.505 2.95 -2.46z" />
                                                <path d="M5 10h3v3h-3z" />
                                                <path d="M8 10h3v3h-3z" />
                                                <path d="M11 10h3v3h-3z" />
                                                <path d="M8 7h3v3h-3z" />
                                                <path d="M11 7h3v3h-3z" />
                                                <path d="M11 4h3v3h-3z" />
                                                <path
                                                    d="M4.571 18c1.5 0 2.047 -.074 2.958 -.78" />
                                                <path d="M10 16l0 .01" />
                                            </svg>
                                            Image Tag</label>
                                        <select class="form-select" id="new-profile-image-tag"
                                            name="select-profile-image-tag">
                                        </select>
                                    </div>
                                </div>
                                <small class="form-hint mt-1">
                                    <p>
                                        The name of the execution profile. This is used to identify the profile in the
                                        tool's page. Each profile is associated with a specific Tool image tag.
                                    </p>
                                </small>
                                <small class="form-hint text-orange mt-1" id="default-profile-msg">

                                </small>
                            </div>

                            <div class="mb-3">
                                <label class="form-label">Description</label>
                                <textarea class="form-control" id="new-profile-description"
                                    name="description" rows="2" placeholder="A descriptive explanation of the profile" maxlength="300">
                                </textarea>
                            </div>
                            
                            <div class="mb-3">
                                <div class="row">
                                    <div class="col-lg-6">
                                        <label class="form-label">
                                            <svg  xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon icon-tabler icons-tabler-outline icon-tabler-cloud-down"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M12 18.004h-5.343c-2.572 -.004 -4.657 -2.011 -4.657 -4.487c0 -2.475 2.085 -4.482 4.657 -4.482c.393 -1.762 1.794 -3.2 3.675 -3.773c1.88 -.572 3.956 -.193 5.444 1c1.488 1.19 2.162 3.007 1.77 4.769h.99c1.38 0 2.573 .813 3.13 1.99" /><path d="M19 16v6" /><path d="M22 19l-3 3l-3 -3" /></svg>
                                            Image Pull Policy</label>
                                        <select class="form-select" id="new-profile-image-pull-policy"
                                            name="image-pull-policy">
                                            <option value="">-</option>
                                            <option value="Always">Always</option>
                                            <option value="IfNotPresent">If Not Present</option>
                                            <option value="Never">Never</option>
                                        </select>
                                    </div>
                                    <div class="col-lg-6">
                                        <label class="form-label">
                                            <svg xmlns="http://www.w3.org/2000/svg"
                                                width="24" height="24"
                                                viewBox="0 0 24 24" fill="none"
                                                stroke="currentColor"
                                                stroke-width="2"
                                                stroke-linecap="round"
                                                stroke-linejoin="round"
                                                class="icon icon-tabler icons-tabler-outline icon-tabler-key">
                                                <path stroke="none"
                                                    d="M0 0h24v24H0z"
                                                    fill="none" />
                                                <path
                                                    d="M16.555 3.843l3.602 3.602a2.877 2.877 0 0 1 0 4.069l-2.643 2.643a2.877 2.877 0 0 1 -4.069 0l-.301 -.301l-6.558 6.558a2 2 0 0 1 -1.239 .578l-.175 .008h-1.172a1 1 0 0 1 -.993 -.883l-.007 -.117v-1.172a2 2 0 0 1 .467 -1.284l.119 -.13l.414 -.414h2v-2h2v-2l2.144 -2.144l-.301 -.301a2.877 2.877 0 0 1 0 -4.069l2.643 -2.643a2.877 2.877 0 0 1 4.069 0z" />
                                                <path d="M15 9h.01" />
                                            </svg>
                                            Image Pull Secret</label>
                                        <select class="form-select" id="new-profile-image-pull-secret">
                                            <option value="">default</option>
                                        </select>
                                    </div>
                                </div>
                                <small class="form-hint mt-1">
                                    <p>
                                        The image pull policy determines when the container image should be pulled
                                        from the registry. <strong>Always</strong> will always pull the latest image,
                                        <strong>If Not Present</strong> will only pull if the image is not already
                                        present, and <strong>Never</strong> will never pull the image. The image pull secret
                                        is used to authenticate with the container registry if the image is private. In most cases
                                        this should be set to <code>default</code> unless you have a specific secret applied by your 
                                        system administrator.
                                    </p>
                                </small>
                            </div>
                            
                            <div class="mb-4">
                                <div class="row">
                                    <div class=col-lg-6>
                                        <label class="form-label">
                                            <svg xmlns="http://www.w3.org/2000/svg"
                                                width="24" height="24"
                                                viewBox="0 0 24 24" fill="none"
                                                stroke="currentColor"
                                                stroke-width="1.25"
                                                stroke-linecap="round"
                                                stroke-linejoin="round"
                                                class="icon icon-tabler icons-tabler-outline icon-tabler-cpu">
                                                <path stroke="none" d="M0 0h24v24H0z"
                                                    fill="none" />
                                                <path
                                                    d="M5 5m0 1a1 1 0 0 1 1 -1h12a1 1 0 0 1 1 1v12a1 1 0 0 1 -1 1h-12a1 1 0 0 1 -1 -1z" />
                                                <path d="M9 9h6v6h-6z" />
                                                <path d="M3 10h2" />
                                                <path d="M3 14h2" />
                                                <path d="M10 3v2" />
                                                <path d="M14 3v2" />
                                                <path d="M21 10h-2" />
                                                <path d="M21 14h-2" />
                                                <path d="M14 21v-2" />
                                                <path d="M10 21v-2" />
                                            </svg>
                                            CPU Resources</label>
                                        <div class="row">
                                            <div class="col-lg-6">
                                                <label class="form-label mt-1">Request</label>
                                                <div class="input-group">
                                                    <select class="form-select" id="new-profile-cpu-request"
                                                        name="task-cpu-request">
                                                            <option value="">-</option>
                                                            <option value="100m">0.1 vCPU</option>
                                                            <option value="200m">0.2 vCPU</option>
                                                            <option value="300m">0.3 vCPU</option>
                                                            <option value="400m">0.4 vCPU</option>
                                                            <option value="500m">0.5 vCPU</option>
                                                            <option value="600m">0.6 vCPU</option>
                                                            <option value="700m">0.7 vCPU</option>
                                                            <option value="800m">0.8 vCPU</option>
                                                            <option value="900m">0.9 vCPU</option>
                                                            <option value="1">1 vCPU</option>
                                                            <option value="2">2 vCPU</option>
                                                            <option value="4">4 vCPU</option>
                                                            <option value="8">8 vCPU</option>
                                                            <option value="16">16 vCPU</option>
                                                        
                                                    </select>
                                                </div>

                                            </div>
                                            <div class="col-lg-6">
                                                <label class="form-label mt-1">Limit</label>
                                                <select class="form-select" id="new-profile-cpu-limit"
                                                        name="task-cpu-request">
                                                            <option value="">-</option>
                                                            <option value="100m">0.1 vCPU</option>
                                                            <option value="200m">0.2 vCPU</option>
                                                            <option value="300m">0.3 vCPU</option>
                                                            <option value="400m">0.4 vCPU</option>
                                                            <option value="500m">0.5 vCPU</option>
                                                            <option value="600m">0.6 vCPU</option>
                                                            <option value="700m">0.7 vCPU</option>
                                                            <option value="800m">0.8 vCPU</option>
                                                            <option value="900m">0.9 vCPU</option>
                                                            <option value="1">1 vCPU</option>
                                                            <option value="2">2 vCPU</option>
                                                            <option value="4">4 vCPU</option>
                                                            <option value="8">8 vCPU</option>
                                                            <option value="16">16 vCPU</option>
                                                </select>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-lg-6">
                                        <label class="form-label">
                                            <svg xmlns="http://www.w3.org/2000/svg"
                                                            width="24" height="24"
                                                            viewBox="0 0 24 24" fill="none"
                                                            stroke="currentColor" stroke-width="2"
                                                            stroke-linecap="round"
                                                            stroke-linejoin="round"
                                                            class="icon icon-tabler icons-tabler-outline icon-tabler-ruler-2">
                                                            <path stroke="none" d="M0 0h24v24H0z"
                                                                fill="none" />
                                                            <path d="M17 3l4 4l-14 14l-4 -4z" />
                                                            <path d="M16 7l-1.5 -1.5" />
                                                            <path d="M13 10l-1.5 -1.5" />
                                                            <path d="M10 13l-1.5 -1.5" />
                                                            <path d="M7 16l-1.5 -1.5" />
                                                        </svg>
                                            Memory Resources</label>
                                        <div class="row">
                                            <div class="col-lg-6">
                                                <label class="form-label mt-1">Request</label>
                                                <select class="form-select" id="new-profile-memory-request"
                                                    name="task-memory-request">
                                                    <option value="">-</option>
                                                    <option value="128Mi">128Mi</option>
                                                    <option value="256Mi">256Mi</option>
                                                    <option value="512Mi">512Mi</option>
                                                    <option value="1Gi">1Gi</option>
                                                    <option value="2Gi">2Gi</option>
                                                    <option value="4Gi">4Gi</option>
                                                    <option value="8Gi">8Gi</option>
                                                    <option value="16Gi">16Gi</option>
                                                    <option value="32Gi">32Gi</option>
                                                    <option value="64Gi">64Gi</option>
                                                    <option value="128Gi">128Gi</option>
                                                    <option value="256Gi">256Gi</option>
                                                </select>
                                            </div>
                                            <div class="col-lg-6">
                                                <label class="form-label mt-1">Limit</label>
                                                <select class="form-select" id="new-profile-memory-limit"
                                                    name="task-memory-limit">
                                                    <option value="">-</option>
                                                    <option value="128Mi">128Mi</option>
                                                    <option value="256Mi">256Mi</option>
                                                    <option value="512Mi">512Mi</option>
                                                    <option value="1Gi">1Gi</option>
                                                    <option value="2Gi">2Gi</option>
                                                    <option value="4Gi">4Gi</option>
                                                    <option value="8Gi">8Gi</option>
                                                    <option value="16Gi">16Gi</option>
                                                    <option value="32Gi">32Gi</option>
                                                    <option value="64Gi">64Gi</option>
                                                    <option value="128Gi">128Gi</option>
                                                    <option value="256Gi">256Gi</option>
                                                </select>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div>
                                <div class="row">
                                    <div class="col-lg-4">
                                        <label class="form-label">
                                            <svg xmlns="http://www.w3.org/2000/svg"
                                                width="24" height="24"
                                                viewBox="0 0 24 24" fill="none"
                                                stroke="currentColor" stroke-width="2"
                                                stroke-linecap="round"
                                                stroke-linejoin="round"
                                                class="icon icon-tabler icons-tabler-outline icon-tabler-time-duration-15">
                                                <path stroke="none" d="M0 0h24v24H0z"
                                                    fill="none" />
                                                <path
                                                    d="M12 15h2a1 1 0 0 0 1 -1v-1a1 1 0 0 0 -1 -1h-2v-3h3" />
                                                <path d="M9 9v6" />
                                                <path d="M3 12v.01" />
                                                <path d="M12 21v.01" />
                                                <path d="M7.5 4.2v.01" />
                                                <path d="M16.5 19.8v.01" />
                                                <path d="M7.5 19.8v.01" />
                                                <path d="M4.2 16.5v.01" />
                                                <path d="M19.8 16.5v.01" />
                                                <path d="M4.2 7.5v.01" />
                                                <path d="M21 12a9 9 0 0 0 -9 -9" />
                                            </svg>
                                            TTL (seconds)</label>
                                        <select class="form-select" id="new-profile-ttl"
                                            name="task-ttl">
                                            <option value="">-</option>
                                            <option value="60">1min</option>
                                            <option value="300">5min</option>
                                            <option value="600">15min</option>
                                            <option value="1800">30min</option>
                                            <option value="3600">1h</option>
                                            <option value="7200">2h</option>
                                            <option value="14400">4h</option>
                                            <option value="21600">6h</option>
                                            <option value="43200">12h</option>
                                            <option value="86400">1d</option>
                                        </select>
                                        <small class="form-hint mt-1">
                                            <p>
                                                The time-to-live (TTL) for tasks created with this profile. This determines how long the
                                                a task job will remain in the cluster after its completion. 
                                            </p>
                                        </small>
                                    </div>
                                    <div class="col-lg-4">
                                        <label class="form-label">
                                            <svg xmlns="http://www.w3.org/2000/svg"
                                                width="24" height="24"
                                                viewBox="0 0 24 24" fill="none"
                                                stroke="currentColor"
                                                stroke-width="2"
                                                stroke-linecap="round"
                                                stroke-linejoin="round"
                                                class="icon icon-tabler icons-tabler-outline icon-tabler-repeat">
                                                <path stroke="none"
                                                    d="M0 0h24v24H0z"
                                                    fill="none" />
                                                <path
                                                    d="M4 12v-3a3 3 0 0 1 3 -3h13m-3 -3l3 3l-3 3" />
                                                <path
                                                    d="M20 12v3a3 3 0 0 1 -3 3h-13m3 3l-3 -3l3 -3" />
                                            </svg>
                                            Retry Policy</label>
                                        <select class="form-select" id="new-profile-retry-policy"
                                            name="retry-policy">
                                            <option value="">-</option>
                                            <option value="Never">Never</option>
                                            <option value="OnFailure">On Failure</option>
                                            <option value="Always">Always</option>
                                        </select>
                                        <small class="form-hint mt-1">
                                            <p>
                                                The retry policy determines when the execution profile should be retried
                                                in case of failure. <strong>Never</strong> will never retry, <strong>On Failure</strong>
                                                will retry only if the execution fails, and <strong>Always</strong> will always retry.
                                            </p>
                                        </small>
                                    </div>
                                    <div class="col-lg-4">
                                        <label class="form-label">
                                            <svg xmlns="http://www.w3.org/2000/svg"
                                                width="24" height="24"
                                                viewBox="0 0 24 24"
                                                fill="none"
                                                stroke="currentColor"
                                                stroke-width="2"
                                                stroke-linecap="round"
                                                stroke-linejoin="round"
                                                class="icon icon-tabler icons-tabler-outline icon-tabler-repeat-off">
                                                <path stroke="none"
                                                    d="M0 0h24v24H0z"
                                                    fill="none" />
                                                <path
                                                    d="M4 12v-3c0 -1.336 .873 -2.468 2.08 -2.856m3.92 -.144h10m-3 -3l3 3l-3 3" />
                                                <path
                                                    d="M20 12v3a3 3 0 0 1 -.133 .886m-1.99 1.984a3 3 0 0 1 -.877 .13h-13m3 3l-3 -3l3 -3" />
                                                <path d="M3 3l18 18" />
                                            </svg>
                                            Retry Limit</label>
                                            <select class="form-select" id="new-profile-backoff-limit"
                                                name="backoff-limit">
                                                <option value="">-</option>
                                                <option value="1">1</option>
                                                <option value="2">2</option>
                                                <option value="3">3</option>
                                                <option value="4">4</option>
                                                <option value="5">5</option>
                                            </select>
                                        <small class="form-hint mt-1">
                                            <p>
                                                The retry limit determines how many times the task job should be retried
                                                in case of failure.
                                            </p>
                                        </small>
                                    </div>
                                </div>



                            </div>
                            
                        
                        </div>
                        <div class="modal-footer" id="new-profile-footer">
                            <a class="btn btn-primary btn-5 ms-auto cursor-pointer disabled" id="create-profile-btn"
                                onclick="createNewProfile()">
                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                                    fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                    stroke-linejoin="round" class="icon icon-2">
                                    <path d="M12 5l0 14"></path>
                                    <path d="M5 12l14 0"></path>
                                </svg>
                                Create new Profile
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        {% include 'footer.html' %}
    </div>

    <script>
        var easyMde = null; // Initialize EasyMDE variable outside the function

        function openMarkdownEditor() {
            $('#edit-markdown-btn').hide();
            $('#save-markdown-btn').show();
            $('#close-editor-btn').show();
            $('#sync-markdown-btn').hide();
            $('#documentation-content').html('<textarea id="markdown-editor"></textarea>');
            easyMde = new EasyMDE({
                element: document.getElementById("markdown-editor"), spellChecker: false,
            });
            $.ajax({
                url: "{{ url_for('rest_workflows_blueprint.api_get_tool', entity_id=tool.id) }}",
                type: "GET",
                dataType: "json",
                success: function (data) {
                    easyMde.value(data.result.notes);
                },
                error: function (error) {
                    if (error.status == 401) {
                        window.reload();
                    }
                }
            });
        }

        function closeMarkdownEditor() {
            $.ajax({
                url: "{{ url_for('rest_workflows_blueprint.api_get_tool', entity_id=tool.id) }}",
                type: "GET",
                dataType: "json",
                success: function (data) {
                    $('#documentation-content').html(data.result.readme);
                    $("markdown-editor").val('');
                    $('#edit-markdown-btn').show();
                    $('#sync-markdown-btn').show();
                    $('#save-markdown-btn').hide();
                    $('#close-editor-btn').hide();
                },
                error: function (error) {
                    console.error("Error loading documentation:", error);
                }
            });
        }

        function saveEditedDocumentation() {
            const readme = easyMde.value();
            const payload = {
                notes: readme
            };
            $('#save-markdown-btn .stelar-symbol').remove();
            $('#documentation-actions').prepend(createLoaderElement(true, true));
            $.ajax({
                url: "{{ url_for('rest_workflows_blueprint.api_patch_tool', entity_id=tool.id) }}",
                type: "PATCH",
                contentType: "application/json; charset=UTF-8",
                data: JSON.stringify(payload),
                success: function (response) {
                    $('#edit-markdown-btn').show();
                    $('#sync-markdown-btn').show();
                    $('#save-markdown-btn').hide();
                    $('#close-editor-btn').hide();
                    $('#documentation-actions .stelar-loader').remove();
                    $('#documentation-actions').prepend(createGreenTick(false));
                    setTimeout(function () {
                        $('#documentation-actions .stelar-symbol').fadeOut(500, function () {
                            $(this).remove();
                        });
                    }, 3000);
                    $('#documentation-content').html(response.result.readme);
                },
                error: function (error) {
                    $('#save-markdown-btn .stelar-loader').remove();
                    $('#save-markdown-btn').prepend(createRedCross(true));
                }
            });
        }
    </script>

    <script>
        var toolGitRepo = "{{ tool.git_repo }}";
        var toolGitUser = "{{ tool.git_user }}";
        var githubAPI = "{{ GITHUB_API }}";
        var githubRAW = "{{ GITHUB_RAW }}";

        function copyText(inputId, alertContainerSelector, alertMessage = 'Copied!') {
            const inputField = document.getElementById(inputId);
            if (!inputField) return;

            navigator.clipboard.writeText(inputField.value);

            // Try to get the container with the provided selector.
            let container = $(alertContainerSelector);
            // If not found and selector doesn't start with '#', try with '#' prepended.
            if (container.length === 0 && alertContainerSelector[0] !== '#') {
                container = $('#' + alertContainerSelector);
            }

            // Remove any existing alert elements from the container.
            container.find('.alert').remove();

            const alertHtml = createAlertElement('success', alertMessage);
            container.prepend(alertHtml);

            setTimeout(function () {
                container.find('.alert').fadeOut(500, function () {
                    $(this).remove();
                });
            }, 2000);
        }

        function updateTool() {

            const gitRepo = "https://github.com/" + document.getElementById("git-repo").value.trim();
            const visibility = document.querySelector('input[name="package-visibility"]:checked').value;
            const license = document.getElementById("license-id").value;
            const payload = {
                git_repository: gitRepo,
                private: visibility === 'private',
                category: document.getElementById("tool-category").value,
                license_id: license,
            };

            if (gitRepo) {
                // Validate the GitHub repository URL
                const gitRepoRegex = /^(https?:\/\/)?(www\.)?github\.com\/[a-zA-Z0-9_-]+\/[a-zA-Z0-9_-]+$/;
                if (!gitRepoRegex.test(gitRepo)) {
                    alert("Please enter a valid GitHub repository URL.");
                    return;
                }
            }
            $('#manage-package-footer .stelar-loader').remove();
            $('#manage-package-footer .alert').remove();
            $('#manage-package-footer').prepend(createLoaderElement(false, true));
            $.ajax({
                url: "{{ url_for('rest_workflows_blueprint.api_patch_tool', entity_id=tool.id) }}",
                type: "PATCH",
                contentType: "application/json;",
                data: JSON.stringify(payload),
                success: function (response) {
                    toolGitRepo = document.getElementById("git-repo").value.trim().replace(toolGitUser + '/', '');
                    refreshCommitList();
                    $('#manage-package-footer .alert').remove();
                    $('#manage-package-footer .stelar-loader').remove();
                    $('#manage-package-footer').prepend(createAlertElement('success', 'Tool updated successfully'));
                    setTimeout(function () {
                        $('#manage-package-footer .alert').fadeOut(500, function () {
                            $(this).remove();
                        });
                    }, 3000);
                },
                error: function (error) {
                    $('#manage-package-footer .alert').remove();
                    $('#update-package-btn .stelar-loader').remove();
                    $('#manage-package-footer').prepend(createAlertElement('danger', 'Failed to update tool'));
                    setTimeout(function () {
                        $('#manage-package-footer .alert').fadeOut(500, function () {
                            $(this).remove();
                        });
                    }, 3000);
                }
            });
        }


        function deleteTool() {
            $.ajax({
                url: "{{ url_for('rest_workflows_blueprint.api_delete_tool', entity_id=tool.id) }}",
                type: "DELETE",
                contentType: "application/json;",
                data: JSON.stringify({ 'purge': true }),
                success: function (response) {
                    window.location.href = "{{ url_for('dashboard_blueprint.tools') }}";
                },
                error: function (error) {
                    $('#modal-delete-tool .alert').remove();
                    $('#modal-delete-tool').append(createAlertElement('danger', 'Failed to delete tool'));
                    setTimeout(function () {
                        $('#modal-delete-tool .alert').fadeOut(500, function () {
                            $(this).remove();
                        });
                    }, 3000);
                }
            })
        }

    </script>
    <script>
        const tagInput = document.getElementById('tagInput');
        const tagsContainer = document.getElementById('tagsContainer');
        const hiddenTagsInput = document.getElementById('hiddenTagsInput');
        const updateTagsIcon = $('#update-tags-icon');

        let tags = hiddenTagsInput.value ? hiddenTagsInput.value.split(',') : [];

        function renderTags() {
            tagsContainer.innerHTML = '';
            tags.forEach((tag, index) => {
                const tagElement = document.createElement('span');
                tagElement.classList.add('tag', 'me-2', 'mb-2');
                tagElement.innerHTML = `
                        ${tag}
                        <a href="#" class="btn-close ms-1" data-index="${index}"></a>
                    `;

                tagsContainer.appendChild(tagElement);
            });
            const closeButtons = document.querySelectorAll('.btn-close');
            closeButtons.forEach(button => {
                button.addEventListener('click', function (event) {
                    event.preventDefault();
                    const index = button.getAttribute('data-index');
                    removeTag(index);
                });
            });
            hiddenTagsInput.value = tags.join(',');
        }

        function removeTag(index) {
            tags.splice(index, 1);
            renderTags();
        }


        function fetchReadMeFromGithubMaster(callback) {
            $.ajax({
                url: `${githubRAW}/${toolGitUser}/${toolGitRepo}/master/README.md`,
                type: "GET",
                dataType: "text",
                success: function (data) {
                    callback(data); // Pass the markdown to the callback
                },
                error: function (error) {
                    $('#documentation-actions .stelar-loader').remove();
                    $('#documentation-actions .stelar-symbol').remove();
                    $('#documentation-actions').prepend(createRedCross(false));
                    setTimeout(function () {
                        $('#documentation-actions .stelar-symbol').fadeOut(500, function () {
                            $(this).remove();
                        });
                    }, 3000);
                    console.error("Error loading README:", error);
                }
            });

        }
        function fetchReadMeFromGithub(callback) {
            if (!githubRAW) {
                console.error("GITHUB_RAW is not defined");
                return;
            } else if (!toolGitRepo | !toolGitUser) {
                return;
            }

            $.ajax({
                url: `${githubRAW}/${toolGitUser}/${toolGitRepo}/main/README.md`,
                type: "GET",
                dataType: "text",
                success: function (data) {
                    callback(data); // Pass the markdown to the callback
                },
                error: function (error) {
                    if (error.status === 404) {
                        // If main branch is not found, try master branch
                        fetchReadMeFromGithubMaster(callback);
                    } else {
                        $('#documentation-actions .stelar-loader').remove();
                        $('#documentation-actions .stelar-symbol').remove();
                        $('#documentation-actions').prepend(createRedCross(false));
                        setTimeout(function () {
                            $('#documentation-actions .stelar-symbol').fadeOut(500, function () {
                                $(this).remove();
                            });
                        }, 3000);
                        console.error("Error loading README:", error);
                    }
                }
            });
        }

        function syncDocumentationFromGithub() {
            $('#documentation-actions .stelar-loader').remove();
            $('#documentation-actions .stelar-symbol').remove();
            $('#documentation-actions').prepend(createLoaderElement(true, true));
            fetchReadMeFromGithub(function (readme) {
                const payload = {
                    notes: readme
                };

                $.ajax({
                    url: "{{ url_for('rest_workflows_blueprint.api_patch_tool', entity_id=tool.id) }}",
                    type: "PATCH",
                    contentType: "application/json; charset=UTF-8",
                    data: JSON.stringify(payload),
                    success: function (response) {
                        $('#documentation-actions .stelar-loader').remove();
                        $('#documentation-actions').prepend(createGreenTick(false));
                        setTimeout(function () {
                            $('#documentation-actions .stelar-symbol').fadeOut(500, function () {
                                $(this).remove();
                            });
                        }, 3000);
                        // Update the documentation with the new readme from the response
                        if (response && response.result && response.result.readme) {
                            $('#documentation-content').html(response.result.readme);
                        }
                    },
                    error: function (error) {
                        $('#documentation-actions .stelar-loader').remove();
                        $('#documentation-actions').prepend(createRedCross(false));
                        setTimeout(function () {
                            $('#documentation-actions .stelar-symbol').fadeOut(500, function () {
                                $(this).remove();
                            });
                        }, 3000);
                        console.error("Error syncing documentation:", error);
                    }
                });
            });
        }

        tagInput.addEventListener('keydown', function (event) {
            if (event.key === 'Enter') {
                event.preventDefault();
                const newTag = tagInput.value.trim();
                if (newTag !== '' && !tags.includes(newTag)) {
                    tags.push(newTag);
                    tagInput.value = '';
                    renderTags();
                }
            }
            if (event.key === 'Backspace' && tagInput.value === '') {
                tags.pop();
                renderTags();
            }
        });

        function updateTags() {
            const tags = hiddenTagsInput.value ? hiddenTagsInput.value.split(',') : [];
            const payload = {
                tags: tags
            };
            $('#update-tags-icon .stelar-symbol').remove();
            updateTagsIcon.prepend(createLoaderElement(true, true));
            $.ajax({
                url: "{{ url_for('rest_workflows_blueprint.api_patch_tool', entity_id=tool.id) }}",
                type: "PATCH",
                contentType: "application/json",
                data: JSON.stringify(payload),
                success: function (response) {
                    $('#update-tags-icon .stelar-loader').remove()
                    updateTagsIcon.prepend(createGreenTick(true));
                },
                error: function (error) {
                    $('#update-tags-icon .stelar-loader').remove()
                    updateTagsIcon.prepend(createRedCross(true));
                }
            });
            setTimeout(function () {
                $('#update-tags-icon .stelar-symbol').fadeOut(500, function () {
                    $(this).remove();
                });
            }, 3000);
        }

        renderTags();

    </script>

    <script>
        function loadLayers(imageTagName) {

            $.ajax({
                url: "{{ url_for('rest_workflows_blueprint.api_get_tag_manifest', entity_id=tool.id, image_tag='')}}/" + imageTagName,
                type: "GET",
                dataType: "json",
                contentType: "application/json",
                success: function (response) {
                    $("#image-layers").html("");
                    var layers = response.result.layers;
                    for (var i = layers.length - 1; i >= 0; i--) {
                        var layer = layers[i];
                        $("#image-layers").append(
                            "<li class='step-item'>" +
                            "<strong>Layer " + layer.index + "</strong><br>" +
                            "&gt;_ <code>" + layer.command.join(" ") + "</code><br>" +
                            "</li>"
                        );
                    }
                    $("#image-layer-modal").modal("show");

                },
                error: function (error) {
                }
            })

        }
    </script>


    <script>
        function fetchAvailableLicenses(callback) {
          $.ajax({
            url: "{{url_for('catalog_blueprint.api_fetch_licenses')}}",
            method: "GET",
            success: function (response) {
              if (response.success) {
                window.availableLicenses = response.result;
                displayLicense();
                // Populate the license dropdown in the publishing modal
                var licenseSelect = $('#license-id');
                licenseSelect.empty();
    
                licenseSelect.append($('<option></option>').attr('value', '').text('Select License'));
    
                window.availableLicenses.forEach(function (license) {
                  var option = $('<option></option>')
                    .attr('value', license.key)
                    .text(license.title + ' - (' + license.key + ')');
                  if (license.image_url) {
                    option.attr('data-image', license.image_url);
                  }
                  licenseSelect.append(option);
                });
    
                //If the dataset already has a license, select it
                currentLicense = "{{ tool.get('license_id') }}";
                if (currentLicense && currentLicense !== 'None') {
                  licenseSelect.val(currentLicense);
                } else {
                  licenseSelect.val('');
                }
    
              } else {
                console.error("Failed to fetch available licenses:", response.message);
              }
            },
            error: function (xhr, status, error) {
              console.error("AJAX request for available licenses failed:", error);
            }
          });
          if (typeof callback === "function") {
            callback();
          }
        }
    
        function displayLicense(){
          licenseSelect = `{{ tool.get('license_id') }}`;
          if (!licenseSelect || licenseSelect === 'None' || licenseSelect === '') {
            return;
          }
          if (window.availableLicenses && window.availableLicenses.length > 0) {
            packageLicense = window.availableLicenses.find(license => license.key === licenseSelect);
            if (packageLicense) {
              const licenseContent = packageLicense.image_url 
            ? `<a href="${packageLicense.url || '#'}" target="_blank"><img style="height:25px;" src="${packageLicense.image_url}" alt="${packageLicense.title}" class="license-image"></a>` 
            : `<a href="${packageLicense.url || '#'}" target="_blank">${packageLicense.title}</a>`;
              $('#tool-license').html(licenseContent);
            }
          }
        }
    </script>
    <script>

        function renderProgrammingLanguage() {
            const programmingLanguage = "{{ tool.get('programming_language') }}";
            const visibility = {{ 'true' if tool.get('private') else 'false'
        }};
        const programmingLanguageIcon = $("#programming-language");
        programmingLanguageIcon.html(getProgrammingLanguageBadge(programmingLanguage));
        programmingLanguageIcon.append(
            `<span class="badge bg-${visibility ? 'danger-lt' : 'success-lt'} ms-2">
                        ${visibility ? 'Private' : 'Public'}
                    </span>`
        );
        }
        renderProgrammingLanguage();

        function parseMessage(message) {
            // Create a temporary element to safely escape HTML
            var div = document.createElement('div');
            div.textContent = message;
            // Replace newlines with <br> so that line breaks are preserved
            return div.innerHTML.replace(/(?:\r\n|\r|\n)/g, '<br>');
        }


        function refreshCommitList() {
            commitPlaceholder = `<li class="step-item"><div class="text-secondary placeholder-glow"><div class="placeholder placeholder-xs col-9"></div><div class="placeholder placeholder-xs col-7"></div></div></li>`;
            $("#git-commits").html(commitPlaceholder + commitPlaceholder + commitPlaceholder + commitPlaceholder + commitPlaceholder);
            getLatestCommits();
        }

        function getLatestCommits() {
            if (!toolGitUser || !toolGitRepo) {
                return;
            }
            else if (!githubAPI) {
                console.error("GITHUB_API is not defined");
                return;
            }
            else if (document.getElementById("git-commits") == null) {
                return;
            }
            $.ajax({
                url: `${githubAPI}/repos/${toolGitUser}/${toolGitRepo}/commits?per_page=4`,
                type: "GET",
                dataType: "json",
                success: function (data) {
                    var commits = "";
                    $.each(data, function (index, commit) {
                        commits += "<li class='step-item'>";
                        commits += "<div class='m-0'>"
                        if (commit.author && commit.author.avatar_url != null && commit.author.html_url != "") {
                            commits += "<span class='avatar avatar-xs avatar-rounded me-2' style='background-image: url(\"" + commit.author.avatar_url + "\")'></span>";
                            commits += "<a href='" + commit.author.html_url + "' target='_blank' class=''>";
                            commits += "<strong class='text-black'>" + commit.commit.author.name + "</strong>" + "</a>";
                        } else {
                            commits += "<span class='avatar avatar-xs avatar-rounded me-2'></span>";
                            commits += "<strong>" + commit.commit.author.name + "</strong>";
                        }
                        commits += "<span class='text-secondary'> at <a href='" + commit.html_url + "' target='_blank' class='text-secondary'>" + formatIsoDate(commit.commit.author.date) + "</a></span></div>";
                        commits += "<div class='mt-2 text-secondary'> <a href='" + commit.html_url + "' target='_blank' class='text-secondary'>" + parseMessage(commit.commit.message) + "</a></div>";
                        commits += "</li>";
                    });
                    $("#git-commits").html(commits);
                },
                error: function (error) {
                    if (error.status == 404) {
                        console.log("Repository not found");

                        $("#git-commits").html(`<div class='text-secondary text-center'><svg  xmlns="http://www.w3.org/2000/svg"  width="48"  height="48"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="h-25 w-25 p-4 icon icon-tabler icons-tabler-outline icon-tabler-zoom-question"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M10 10m-7 0a7 7 0 1 0 14 0a7 7 0 1 0 -14 0" /><path d="M21 21l-6 -6" /><path d="M10 13l0 .01" /><path d="M10 10a1.5 1.5 0 1 0 -1.14 -2.474" /></svg> <br>Make sure the repository is public and exists</div>`);


                    } else if (error.status == 403) {
                        console.log("API rate limit exceeded. Please try again later.");
                    } else {
                        console.log("Error fetching commits:", error);
                    }
                }
            });
        }

        function renderImageSelectors(images){
            if(images.length === 0) {
                $('#add-profile-btn').addClass('disabled');
                $('#add-profile-btn').attr('title', 'No tool images available to create a profile');
            }else{
                $('#add-profile-btn').removeClass('disabled');
                $('#add-profile-btn').attr('title', 'Create a new execution profile for an selected image');
            }
            $('#new-profile-image-tag').empty();
            images.forEach(image => {
                const option = `<option value="${image.name}">${image.name}</option>`;
                $('#new-profile-image-tag').append(option);
            });
        }

        function fetchToolImages() {
            $.ajax({
                url: "{{ url_for('rest_workflows_blueprint.api_get_tool', entity_id=tool.id) }}",
                type: "GET",
                dataType: "json",
                success: function (data) {
                    renderToolImages(data.result.images);
                    renderProfiles(data.result.profiles);
                    renderImageSelectors(data.result.images);
                },
                error: function (error) {
                    console.error("Error loading tool images:", error);
                }
            });
        }

        function formatBytes(bytes) {
            const GiB = 1024 * 1024 * 1024;
            const MiB = 1024 * 1024;
            if (bytes < GiB) {
                return Math.round(bytes / MiB) + " MiB";
            } else {
                return Math.round(bytes / GiB) + " GiB";
            }
        }

        function timeAgo(rfc2822Timestamp) {
            const past = new Date(rfc2822Timestamp);
            const now = new Date();
            const diffInSeconds = Math.floor((now - past) / 1000);

            if (diffInSeconds < 60) {
                return diffInSeconds + (diffInSeconds === 1 ? " second ago" : " seconds ago");
            }

            const diffInMinutes = Math.floor(diffInSeconds / 60);
            if (diffInMinutes < 60) {
                return diffInMinutes + (diffInMinutes === 1 ? " minute ago" : " minutes ago");
            }

            const diffInHours = Math.floor(diffInMinutes / 60);
            if (diffInHours < 24) {
                return diffInHours + (diffInHours === 1 ? " hour ago" : " hours ago");
            }

            const diffInDays = Math.floor(diffInHours / 24);
            return diffInDays + (diffInDays === 1 ? " day ago" : " days ago");
        }

        function renderToolImages(images, refresh = false) {
            const toolImagesContainer = $("#tool-images");
            toolImagesContainer.empty(); // Clear existing content

            placeholder = "<div class='text-secondary placeholder-glow'><div class='placeholder placeholder-xs col-9'></div><div class='placeholder placeholder-xs col-7'></div></div>";
            if (refresh) {
                toolImagesContainer.append(placeholder + placeholder + placeholder);
            }
            if (images.length === 0) {
                toolImagesContainer.append("<div class='text-secondary text-center'>No images have been pushed yet.</div>");
                return;
            }

            images.forEach((image, index) => {
                const imageElement = `
                <div class="row">
                    <div class="col">
                        <strong> ${image.name} </strong>
                        <div class="text-secondary">
                            <div class="list-inline list-inline-dots mb-0 text-secondary">
                                <div class="list-inline-item">${timeAgo(image.last_modified)}</div>
                                <div class="list-inline-item">${formatBytes(image.size)}</div>
                            </div>
                        </div>
                    </div>
                    <div class="col-auto align-self-center">
                        <span class="badge badge-outline text-purple">sha256</span>
                        <a class="text-link cursor-pointer" onclick="loadLayers('${image.name}')">
                            ${image.manifest_digest.replace(/^sha256:/, '').substring(0, 12)}
                        </a>
                    </div>
                </div >`;
                toolImagesContainer.append(imageElement);
            });
        }

        //Get the images from the registry and the latest commits from the GitHub repository
        $(document).ready(function () {
            getLatestCommits();
            fetchToolImages();
        });
    </script>
    <script>

        function renderProfile(name, spec) {
            return `<div class="col-lg-6">
                        <div class="card">
                            <div class="card-header d-flex">
                                <h3 class="card-title"><code>${name}</code>
                                ${name === 'default' ? '<span class="text-orange h5 ms-1">Overrides system\'s default</span>' : ''}
                                </h3>
                                <div class="ms-auto">
                                    <a class="cursor-pointer text-link text-danger"
                                        onclick="deleteProfile('${name}')">
                                        <svg xmlns="http://www.w3.org/2000/svg"
                                            width="24" height="24" viewBox="0 0 24 24"
                                            fill="none" stroke="currentColor"
                                            stroke-width="2" stroke-linecap="round"
                                            stroke-linejoin="round"
                                            class="icon icon-tabler icons-tabler-outline icon-tabler-trash">
                                            <path stroke="none" d="M0 0h24v24H0z"
                                                fill="none" />
                                            <path d="M4 7l16 0" />
                                            <path d="M10 11l0 6" />
                                            <path d="M14 11l0 6" />
                                            <path
                                                d="M5 7l1 12a2 2 0 0 0 2 2h8a2 2 0 0 0 2 -2l1 -12" />
                                            <path
                                                d="M9 7v-3a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v3" />
                                        </svg>
                                    </a>
                                </div>
                            </div>
                            <div class="card-body">
                                <div class="datagrid">
                                    <div class="row">
                                        <div class="col-lg-5">
                                            <div class="datagrid-item">
                                                <div class="datagrid-title">
                                                    <svg xmlns="http://www.w3.org/2000/svg"
                                                        width="24" height="24"
                                                        viewBox="0 0 24 24" fill="none"
                                                        stroke="currentColor"
                                                        stroke-width="2"
                                                        stroke-linecap="round"
                                                        stroke-linejoin="round"
                                                        class="m-0 icon icon-tabler icons-tabler-outline icon-tabler-brand-docker">
                                                        <path stroke="none"
                                                            d="M0 0h24v24H0z"
                                                            fill="none" />
                                                        <path
                                                            d="M22 12.54c-1.804 -.345 -2.701 -1.08 -3.523 -2.94c-.487 .696 -1.102 1.568 -.92 2.4c.028 .238 -.32 1 -.557 1h-14c0 5.208 3.164 7 6.196 7c4.124 .022 7.828 -1.376 9.854 -5c1.146 -.101 2.296 -1.505 2.95 -2.46z" />
                                                        <path d="M5 10h3v3h-3z" />
                                                        <path d="M8 10h3v3h-3z" />
                                                        <path d="M11 10h3v3h-3z" />
                                                        <path d="M8 7h3v3h-3z" />
                                                        <path d="M11 7h3v3h-3z" />
                                                        <path d="M11 4h3v3h-3z" />
                                                        <path
                                                            d="M4.571 18c1.5 0 2.047 -.074 2.958 -.78" />
                                                        <path d="M10 16l0 .01" />
                                                    </svg>
                                                    IMAGE TAG
                                                </div>
                                                <div class="datagrid-content">
                                                    <kbd>${spec.image || 'Not defined'}</kbd>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-lg-7">
                                            <div class="datagrid-item">
                                                <div class="datagrid-title">
                                                    <svg xmlns="http://www.w3.org/2000/svg"
                                                        width="24" height="24"
                                                        viewBox="0 0 24 24" fill="none"
                                                        stroke="currentColor"
                                                        stroke-width="2"
                                                        stroke-linecap="round"
                                                        stroke-linejoin="round"
                                                        class="icon icon-tabler icons-tabler-outline icon-tabler-key">
                                                        <path stroke="none"
                                                            d="M0 0h24v24H0z"
                                                            fill="none" />
                                                        <path
                                                            d="M16.555 3.843l3.602 3.602a2.877 2.877 0 0 1 0 4.069l-2.643 2.643a2.877 2.877 0 0 1 -4.069 0l-.301 -.301l-6.558 6.558a2 2 0 0 1 -1.239 .578l-.175 .008h-1.172a1 1 0 0 1 -.993 -.883l-.007 -.117v-1.172a2 2 0 0 1 .467 -1.284l.119 -.13l.414 -.414h2v-2h2v-2l2.144 -2.144l-.301 -.301a2.877 2.877 0 0 1 0 -4.069l2.643 -2.643a2.877 2.877 0 0 1 4.069 0z" />
                                                        <path d="M15 9h.01" />
                                                    </svg>
                                                    IMAGE PULL SECRET
                                                </div>
                                                <div class="datagrid-content">
                                                    <kbd>${spec.image_pull_secrets || 'Using Cluster Default'}</kbd>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="datagrid-item">
                                        <div class="datagrid-title">
                                            <svg  xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon icon-tabler icons-tabler-outline icon-tabler-cloud-down"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M12 18.004h-5.343c-2.572 -.004 -4.657 -2.011 -4.657 -4.487c0 -2.475 2.085 -4.482 4.657 -4.482c.393 -1.762 1.794 -3.2 3.675 -3.773c1.88 -.572 3.956 -.193 5.444 1c1.488 1.19 2.162 3.007 1.77 4.769h.99c1.38 0 2.573 .813 3.13 1.99" /><path d="M19 16v6" /><path d="M22 19l-3 3l-3 -3" /></svg>
                                            IMAGE PULL POLICY
                                        </div>
                                        <div class="datagrid-content">
                                            <kbd>${spec.image_pull_policy || 'Always'}</kbd>
                                        </div>
                                    </div>
                                    <div class="datagrid-item">
                                        <div class="datagrid-title">
                                            <svg xmlns="http://www.w3.org/2000/svg"
                                                width="24" height="24"
                                                viewBox="0 0 24 24" fill="none"
                                                stroke="currentColor" stroke-width="2"
                                                stroke-linecap="round"
                                                stroke-linejoin="round"
                                                class="m-0 icon icon-tabler icons-tabler-outline icon-tabler-file-description">
                                                <path stroke="none" d="M0 0h24v24H0z"
                                                    fill="none" />
                                                <path d="M14 3v4a1 1 0 0 0 1 1h4" />
                                                <path
                                                    d="M17 21h-10a2 2 0 0 1 -2 -2v-14a2 2 0 0 1 2 -2h7l5 5v11a2 2 0 0 1 -2 2z" />
                                                <path d="M9 17h6" />
                                                <path d="M9 13h6" />
                                            </svg>
                                            Description
                                        </div>
                                        <div class="datagrid-content">
                                            <div class="text-muted">
                                               ${spec.description || 'No description provided'}
                                            </div>
                                        </div>
                                    </div>
                                    <div class="datagrid-item">
                                        <div class="datagrid-title">
                                            <svg xmlns="http://www.w3.org/2000/svg"
                                                width="24" height="24"
                                                viewBox="0 0 24 24" fill="none"
                                                stroke="currentColor"
                                                stroke-width="1.25"
                                                stroke-linecap="round"
                                                stroke-linejoin="round"
                                                class="icon icon-tabler icons-tabler-outline icon-tabler-cpu">
                                                <path stroke="none" d="M0 0h24v24H0z"
                                                    fill="none" />
                                                <path
                                                    d="M5 5m0 1a1 1 0 0 1 1 -1h12a1 1 0 0 1 1 1v12a1 1 0 0 1 -1 1h-12a1 1 0 0 1 -1 -1z" />
                                                <path d="M9 9h6v6h-6z" />
                                                <path d="M3 10h2" />
                                                <path d="M3 14h2" />
                                                <path d="M10 3v2" />
                                                <path d="M14 3v2" />
                                                <path d="M21 10h-2" />
                                                <path d="M21 14h-2" />
                                                <path d="M14 21v-2" />
                                                <path d="M10 21v-2" />
                                            </svg>
                                            CPU Resources
                                        </div>
                                        <div class="datagrid-content">
                                            <div class="row">
                                                <div class="col-6">
                                                    Requested: <span
                                                        class="badge bg-${spec.cpu_request ? 'green-lt' : 'secondary-lt'}">
                                                        ${spec.cpu_request || '-'}
                                                    </span>
                                                </div>
                                                <div class="col-6">
                                                    Limit: <span
                                                        class="badge bg-${spec.cpu_limit ? 'danger-lt' : 'secondary-lt'}">
                                                        ${spec.cpu_limit || '-'}
                                                    </span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="datagrid-item">
                                        <div class="datagrid-title">
                                            <svg xmlns="http://www.w3.org/2000/svg"
                                                width="24" height="24"
                                                viewBox="0 0 24 24" fill="none"
                                                stroke="currentColor" stroke-width="2"
                                                stroke-linecap="round"
                                                stroke-linejoin="round"
                                                class="icon icon-tabler icons-tabler-outline icon-tabler-ruler-2">
                                                <path stroke="none" d="M0 0h24v24H0z"
                                                    fill="none" />
                                                <path d="M17 3l4 4l-14 14l-4 -4z" />
                                                <path d="M16 7l-1.5 -1.5" />
                                                <path d="M13 10l-1.5 -1.5" />
                                                <path d="M10 13l-1.5 -1.5" />
                                                <path d="M7 16l-1.5 -1.5" />
                                            </svg>
                                            MEMORY Resources
                                        </div>
                                        <div class="datagrid-content">
                                            <div class="row">
                                                <div class="col-6">
                                                    Requested: <span
                                                        class="badge bg-${spec.memory_request ? 'green-lt' : 'secondary-lt'}">
                                                        ${spec.memory_request || '-'}
                                                    </span>
                                                </div>
                                                <div class="col-6">
                                                    Limit: <span
                                                        class="badge bg-${spec.memory_limit ? 'danger-lt' : 'secondary-lt'}">
                                                        ${spec.memory_limit || '-'}
                                                    </span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="datagrid-item">
                                        <div class="datagrid-title">
                                            <svg xmlns="http://www.w3.org/2000/svg"
                                                width="24" height="24"
                                                viewBox="0 0 24 24" fill="none"
                                                stroke="currentColor" stroke-width="2"
                                                stroke-linecap="round"
                                                stroke-linejoin="round"
                                                class="icon icon-tabler icons-tabler-outline icon-tabler-time-duration-15">
                                                <path stroke="none" d="M0 0h24v24H0z"
                                                    fill="none" />
                                                <path
                                                    d="M12 15h2a1 1 0 0 0 1 -1v-1a1 1 0 0 0 -1 -1h-2v-3h3" />
                                                <path d="M9 9v6" />
                                                <path d="M3 12v.01" />
                                                <path d="M12 21v.01" />
                                                <path d="M7.5 4.2v.01" />
                                                <path d="M16.5 19.8v.01" />
                                                <path d="M7.5 19.8v.01" />
                                                <path d="M4.2 16.5v.01" />
                                                <path d="M19.8 16.5v.01" />
                                                <path d="M4.2 7.5v.01" />
                                                <path d="M21 12a9 9 0 0 0 -9 -9" />
                                            </svg>
                                            TTL
                                        </div>
                                        <div class="datagrid-content">
                                            <span>${spec.ttl_seconds_after_finished || '24h'}</span>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-lg-6">
                                            <div class="datagrid-item">
                                                <div class="datagrid-title">
                                                    <svg xmlns="http://www.w3.org/2000/svg"
                                                        width="24" height="24"
                                                        viewBox="0 0 24 24" fill="none"
                                                        stroke="currentColor"
                                                        stroke-width="2"
                                                        stroke-linecap="round"
                                                        stroke-linejoin="round"
                                                        class="icon icon-tabler icons-tabler-outline icon-tabler-repeat">
                                                        <path stroke="none"
                                                            d="M0 0h24v24H0z"
                                                            fill="none" />
                                                        <path
                                                            d="M4 12v-3a3 3 0 0 1 3 -3h13m-3 -3l3 3l-3 3" />
                                                        <path
                                                            d="M20 12v3a3 3 0 0 1 -3 3h-13m3 3l-3 -3l3 -3" />
                                                    </svg>
                                                    Retry Policy
                                                </div>
                                                <div class="datagrid-content">
                                                    <span class="badge bg-${spec.restart_policy === 'Always' ? 'orange-lt' : spec.restart_policy === 'OnFailure' ? 'green-lt' : 'danger-lt'}">
                                                        ${spec.restart_policy === 'Always' ? 'Always' : spec.restart_policy === 'OnFailure' ? 'On Failure' : 'Never'}
                                                    </span>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-lg-6">
                                            <div class="datagrid-item">
                                                <div class="datagrid-title">
                                                    <svg xmlns="http://www.w3.org/2000/svg"
                                                        width="24" height="24"
                                                        viewBox="0 0 24 24" fill="none"
                                                        stroke="currentColor"
                                                        stroke-width="2"
                                                        stroke-linecap="round"
                                                        stroke-linejoin="round"
                                                        class="icon icon-tabler icons-tabler-outline icon-tabler-repeat-off">
                                                        <path stroke="none"
                                                            d="M0 0h24v24H0z"
                                                            fill="none" />
                                                        <path
                                                            d="M4 12v-3c0 -1.336 .873 -2.468 2.08 -2.856m3.92 -.144h10m-3 -3l3 3l-3 3" />
                                                        <path
                                                            d="M20 12v3a3 3 0 0 1 -.133 .886m-1.99 1.984a3 3 0 0 1 -.877 .13h-13m3 3l-3 -3l3 -3" />
                                                        <path d="M3 3l18 18" />
                                                    </svg>
                                                    Retry Limit
                                                </div>
                                                <div class="datagrid-content">
                                                    ${spec.backoff_limit ? spec.backoff_limit + " times" : '3 times'}
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>`;
        }

        function renderProfiles(profiles) {
            const profilesContainer = $("#profiles-container");
            profilesContainer.empty();
            if (profiles.length === 0) {
                profilesContainer.append("<div class='text-secondary text-center'>No profiles defined for this tool.</div>");
                return;
            }
            Object.entries(profiles).forEach(([name, spec]) => profilesContainer.append(renderProfile(name, spec)));
        }


        function deleteProfile(profileName){
            if (!confirm("Are you sure you want to delete the profile: " + profileName + "?")) {
                return;
            }

            $.ajax({
                url: `{{ url_for('rest_workflows_blueprint.api_get_tool', entity_id=tool.get('id')) }}`,
                type: "GET",
                dataType: "json",
                success: function (data) {
                    deleteProfileFromTool(profileName, data.result.profiles);
                },
                error: function (error) {
                    console.error("Error loading tool profiles:", error);
                }
            });
        }

        function deleteProfileFromTool(profileName, currentProfiles) {
            $.ajax({
                url: `{{ url_for('rest_workflows_blueprint.api_patch_tool', entity_id=tool.get('id')) }}`,
                type: "PATCH",
                contentType: "application/json",
                data: JSON.stringify({
                    profiles: Object.fromEntries(Object.entries(currentProfiles).filter(([key]) => key !== profileName))
                }),
                success: function (response) {
                    renderProfiles(response.result.profiles);
                },
                error: function (error) {
                    console.error("Error deleting profile:", error);
                }
            });
        }


        function addProfile(){
            $("#new-profile-modal").modal("show");
        }


        function validateNewProfile() {
            const newProfileName = document.getElementById("new-profile-name");
            const footerButton = document.getElementById("create-profile-btn");

            const profileNameValue = newProfileName.value.trim();
            const isValidName = /^[a-zA-Z0-9_]+$/.test(profileNameValue);

            if (profileNameValue === "") {
                newProfileName.classList.remove("is-valid", "is-invalid");
                footerButton.classList.add("disabled");
                $('#default-profile-msg').empty();
                return;
            }

            if (profileNameValue === "default") {
                $('#default-profile-msg').empty();
                $('#default-profile-msg').text("Creating a profile named 'default' will override the system's default profile for this tool.");
            }

            if (isValidName) {
                newProfileName.classList.add("is-valid");
                newProfileName.classList.remove("is-invalid");
                footerButton.classList.remove("disabled");
            } else {
                newProfileName.classList.add("is-invalid");
                newProfileName.classList.remove("is-valid");
                footerButton.classList.add("disabled");
            }
        }

        $(document).ready(function () {
            const newProfileName = document.getElementById("new-profile-name");
            newProfileName.addEventListener("input", validateNewProfile);
            newProfileName.addEventListener("blur", validateNewProfile);
            newProfileName.addEventListener("keyup", validateNewProfile);
        });

        function resetNewProfileForm(){
            document.getElementById("new-profile-name").value = '';
            document.getElementById("new-profile-image-pull-secret").value = '';
            document.getElementById("new-profile-image-pull-policy").value = '';
            document.getElementById("new-profile-description").value = '';
            document.getElementById("new-profile-cpu-request").value = '';
            document.getElementById("new-profile-cpu-limit").value = '';
            document.getElementById("new-profile-memory-request").value = '';
            document.getElementById("new-profile-memory-limit").value = '';
            document.getElementById("new-profile-ttl").value = '';
            document.getElementById("new-profile-retry-policy").value = '';
            document.getElementById("new-profile-backoff-limit").value = '';
        }

        function createNewProfile(){

            $('#new-profile-footer .stelar-loader').remove();
            $('#new-profile-footer .alert').remove();
            $('#new-profile-footer').prepend(createLoaderElement(false, true));
            $('#create-profile-btn').addClass("disabled");

            $.ajax({
                url: `{{ url_for('rest_workflows_blueprint.api_get_tool', entity_id=tool.get('id')) }}`,
                type: "GET",
                dataType: "json",
                success: function (data) {
                    addProfileToTool(data.result.profiles);
                },
                error: function (error) {
                    $('#new-profile-footer .stelar-loader').remove();
                    $('#create-profile-btn').removeClass("disabled");
                    $('#new-profile-footer .alert').remove();
                    $('#new-profile-footer').prepend(createAlertElement("danger", "Error loading tool profiles"));
                }
            });            
        }


        function addProfileToTool(currentProfiles)  {
            const newProfileName = document.getElementById("new-profile-name").value.trim();
            if (newProfileName === "") {
                return;
            }

            const newProfile = {
                image: document.getElementById("new-profile-image-tag").value.trim(),
                ...(document.getElementById("new-profile-image-pull-secret").value.trim() && { image_pull_secrets: document.getElementById("new-profile-image-pull-secret").value.trim() }),
                ...(document.getElementById("new-profile-image-pull-policy").value.trim() && { image_pull_policy: document.getElementById("new-profile-image-pull-policy").value.trim() }),
                ...(document.getElementById("new-profile-description").value.trim() && { description: document.getElementById("new-profile-description").value.trim() }),
                ...(document.getElementById("new-profile-cpu-request").value.trim() && { cpu_request: document.getElementById("new-profile-cpu-request").value.trim() }),
                ...(document.getElementById("new-profile-cpu-limit").value.trim() && { cpu_limit: document.getElementById("new-profile-cpu-limit").value.trim() }),
                ...(document.getElementById("new-profile-memory-request").value.trim() && { memory_request: document.getElementById("new-profile-memory-request").value.trim() }),
                ...(document.getElementById("new-profile-memory-limit").value.trim() && { memory_limit: document.getElementById("new-profile-memory-limit").value.trim() }),
                ...(document.getElementById("new-profile-ttl").value.trim() && { ttl_seconds_after_finished: document.getElementById("new-profile-ttl").value.trim() }),
                ...(document.getElementById("new-profile-retry-policy").value.trim() && { restart_policy: document.getElementById("new-profile-retry-policy").value.trim() }),
                ...(document.getElementById("new-profile-backoff-limit").value.trim() && { backoff_limit: parseInt(document.getElementById("new-profile-backoff-limit").value.trim()) }),
            };

            // If profile name already exists, show an error
            if (currentProfiles.hasOwnProperty(newProfileName)) {
                $('#new-profile-footer .stelar-loader').remove();
                $('#create-profile-btn').removeClass("disabled");
                $('#new-profile-footer .alert').remove();
                $('#new-profile-footer').prepend(createAlertElement("danger", "Profile name already exists"));
                setTimeout(function () {
                    $('#new-profile-footer .alert').fadeOut(500, function () {
                        $(this).remove();
                    });
                }, 3000);
                return;
            }

            $.ajax({
                url: `{{ url_for('rest_workflows_blueprint.api_patch_tool', entity_id=tool.get('id')) }}`,
                type: "PATCH",
                contentType: "application/json",
                data: JSON.stringify({
                    profiles: {
                        ...currentProfiles,
                        [newProfileName]: newProfile
                    }
                }),
                success: function (response) {
                    renderProfiles(response.result.profiles);
                    resetNewProfileForm();
                    $('#new-profile-footer .stelar-loader').remove();
                    $('#create-profile-btn').removeClass("disabled");
                    $('#new-profile-footer .alert').remove();
                    $('#new-profile-footer').prepend(createAlertElement("success", "Profile created successfully"));
                    setTimeout(function () {
                        $('#new-profile-footer .alert').fadeOut(500, function () {
                            $(this).remove();
                        });
                    }, 3000);
                    validateNewProfile();
                },
                error: function (error) {
                    $('#new-profile-footer .stelar-loader').remove();
                    $('#create-profile-btn').removeClass("disabled");
                    $('#new-profile-footer .alert').remove();
                    $('#new-profile-footer').prepend(createAlertElement("danger", "Error creating profile"));
                    setTimeout(function () {
                        $('#new-profile-footer .alert').fadeOut(500, function () {
                            $(this).remove();
                        });
                    }, 3000);
                    console.error("Error creating profile:", error);
                    validateNewProfile();
                }
            });
            
        }
    </script>
    <script>

        currentInput = {{ tool.get('inputs') | tojson | safe }};
        currentOutput = {{ tool.get('outputs') | tojson | safe }};
        currentParameters = {{ tool.get('parameters') | tojson | safe }};

        function renderInputs() {
            const inputsList = $("#inputs-list");
            inputsList.empty(); // Clear existing content

            if (Object.keys(currentInput).length === 0) {
                inputsList.append("<tr><td colspan='5' class='text-center text-secondary'>No inputs defined for this tool.</td></tr>");
                return;
            }

            Object.keys(currentInput).forEach(inputName => {
                const input = currentInput[inputName];
                const inputElement = `
                <tr id="input-${inputName}" class="input-item">
                <td class="text-center p-2">
                    <code>${inputName}</code>
                </td>
                <td class="p-2">
                    <span class="text-secondary">${input.description || ''}</span>
                </td>
                <td class="text-center p-2">
                    <span class="text-secondary">${input.format || ''}</span>
                </td>
                <td class="text-center p-2">
                    ${input.required ? '<span class="badge bg-success-lt">Yes</span>' : '<span class="badge bg-secondary-lt">No</span>'}
                </td>
                <td class="text-center p-2">
                    <a class="text-link text-danger cursor-pointer" onclick="removeInput('${inputName}')">Remove</a>
                </td>
                </tr>
            `;
                inputsList.append(inputElement);
            });
        }

        function validateNewInput() {
            const newInputName = document.getElementById("new-input-name");
            const newInputDescription = document.getElementById("new-input-description");
            const newInputRequired = document.getElementById("new-input-required");
            const newInputFormat = document.getElementById("new-input-format");
            const footerButton = document.getElementById("new-input-footer").querySelector("button");

            const inputNameValue = newInputName.value.trim();
            const inputDescriptionValue = newInputDescription.value.trim();
            const isValidName = /^[a-zA-Z0-9_]+$/.test(inputNameValue);

            if (inputNameValue === "" || inputDescriptionValue === "") {
                newInputName.classList.remove("is-valid", "is-invalid");
                footerButton.classList.add("disabled");
                return;
            }

            if (isValidName) {
                newInputName.classList.add("is-valid");
                newInputName.classList.remove("is-invalid");
                footerButton.classList.remove("disabled");
            } else {
                newInputName.classList.add("is-invalid");
                newInputName.classList.remove("is-valid");
                footerButton.classList.add("disabled");
            }
        }

        function attachNewInputValidation() {
            const newInputName = document.getElementById("new-input-name");
            newInputName.addEventListener("input", validateNewInput);
            newInputName.addEventListener("blur", validateNewInput);
            newInputName.addEventListener("keyup", validateNewInput);
            const newInputDescription = document.getElementById("new-input-description");
            newInputDescription.addEventListener("input", validateNewInput);
            newInputDescription.addEventListener("blur", validateNewInput);
            newInputDescription.addEventListener("keyup", validateNewInput);
            const newInputRequired = document.getElementById("new-input-required");
        }

        function createNewInput() {
            const newInputName = document.getElementById("new-input-name").value.trim();
            const newInputDescription = document.getElementById("new-input-description").value.trim();
            const newInputRequired = document.getElementById("new-input-required").checked;
            const newInputFormat = document.getElementById("new-input-format").value.toUpperCase();


            if (newInputName === "" || newInputDescription === "") {
                return;
            }

            $('#new-input-footer .stelar-loader').remove();
            $('#new-input-footer .alert').remove();
            $('#new-input-footer').prepend(createLoaderElement(false, true));

            const newInput = {
                description: newInputDescription,
                required: newInputRequired,
                format: newInputFormat
            };

            $.ajax({
                url: `{{ url_for('rest_workflows_blueprint.api_patch_tool', entity_id=tool.get('id')) }}`,
                type: "PATCH",
                contentType: "application/json",
                data: JSON.stringify({
                    inputs: { ...currentInput, [newInputName]: newInput }
                }),
                success: function (response) {
                    currentInput = response.result.inputs;
                    renderInputs();
                    document.getElementById("new-input-name").value = '';
                    document.getElementById("new-input-name").classList.remove("is-valid", "is-invalid");
                    document.getElementById("new-input-description").value = '';
                    document.getElementById("new-input-required").checked = false;
                    document.getElementById("new-input-format").value = 'csv';
                    $('#new-input-footer .stelar-loader').remove();
                    $('#new-input-footer').prepend(createAlertElement("success", "Input created successfully"));
                    setTimeout(function () {
                        $('#new-input-footer .alert').fadeOut(500, function () {
                            $(this).remove();
                        });
                    }, 3000);
                },
                error: function (error) {
                    $('#new-input-footer .stelar-loader').remove();
                    $('#new-input-footer').prepend(createAlertElement("danger", "Error creating input"));
                    setTimeout(function () {
                        $('#new-input-footer .alert').fadeOut(500, function () {
                            $(this).remove();
                        });
                    }, 3000);
                    console.error("Error creating input:", error);
                }
            });
        }

        function removeInput(inputName) {
            confirmation = confirm("Are you sure you want to remove the input: " + inputName + "?");
            if (!confirmation) {
                return;
            }
            $.ajax({
                url: `{{ url_for('rest_workflows_blueprint.api_patch_tool', entity_id=tool.get('id')) }}`,
                type: "PATCH",
                contentType: "application/json",
                data: JSON.stringify({
                    inputs: Object.fromEntries(Object.entries(currentInput).filter(([key]) => key !== inputName))
                }),
                success: function (response) {
                    currentInput = response.result.inputs;
                    renderInputs();
                },
                error: function (error) {
                    console.error("Error removing input:", error);
                }
            });
        }


        function validateNewOutput() {
            const newOutputName = document.getElementById("new-output-name");
            const newOutputDescription = document.getElementById("new-output-description");
            const newOutputFormat = document.getElementById("new-output-format");
            const footerButton = document.getElementById("new-output-footer").querySelector("button");

            const outputNameValue = newOutputName.value.trim();
            const outputDescriptionValue = newOutputDescription.value.trim();
            const isValidName = /^[a-zA-Z0-9_]+$/.test(outputNameValue);

            if (outputNameValue === "" || outputDescriptionValue === "") {
                newOutputName.classList.remove("is-valid", "is-invalid");
                footerButton.classList.add("disabled");
                return;
            }

            if (isValidName) {
                newOutputName.classList.add("is-valid");
                newOutputName.classList.remove("is-invalid");
                footerButton.classList.remove("disabled");
            } else {
                newOutputName.classList.add("is-invalid");
                newOutputName.classList.remove("is-valid");
                footerButton.classList.add("disabled");
            }
        }

        function attachNewOutputValidation() {
            const newOutputName = document.getElementById("new-output-name");
            newOutputName.addEventListener("input", validateNewOutput);
            newOutputName.addEventListener("blur", validateNewOutput);
            newOutputName.addEventListener("keyup", validateNewOutput);
            const newOutputDescription = document.getElementById("new-output-description");
            newOutputDescription.addEventListener("input", validateNewOutput);
            newOutputDescription.addEventListener("blur", validateNewOutput);
            newOutputDescription.addEventListener("keyup", validateNewOutput);
        }

        function renderOutputs() {
            const outputsList = $("#outputs-list");
            outputsList.empty(); // Clear existing content

            if (Object.keys(currentOutput).length === 0) {
                outputsList.append("<tr><td colspan='5' class='text-center text-secondary'>No outputs defined for this tool.</td></tr>");
                return;
            }

            Object.keys(currentOutput).forEach(outputName => {
                const output = currentOutput[outputName];
                const outputElement = `
                    <tr id="output-${outputName}" class="output-item">
                        <td class="text-center p-2">
                            <code>${outputName}</code>
                        </td>
                        <td class="p-2">
                            <span class="text-secondary">${output.description || ''}</span>
                        </td>
                        <td class="text-center p-2">
                            <span class="text-secondary">${output.format || ''}</span>
                        </td>
                        <td class="text-center p-2">
                            <a class="text-link text-danger cursor-pointer" onclick="removeOutput('${outputName}')">Remove</a>
                        </td>
                    </tr>
                `;
                outputsList.append(outputElement);
            });
        }

        function createNewOutput() {
            const newOutputName = document.getElementById("new-output-name").value.trim();
            const newOutputDescription = document.getElementById("new-output-description").value.trim();
            const newOutputFormat = document.getElementById("new-output-format").value.toUpperCase();

            if (newOutputName === "" || newOutputDescription === "") {
                return;
            }

            $('#new-output-footer .stelar-loader').remove();
            $('#new-output-footer .alert').remove();
            $('#new-output-footer').prepend(createLoaderElement(false, true));

            const newOutput = {
                description: newOutputDescription,
                format: newOutputFormat
            };

            $.ajax({
                url: `{{ url_for('rest_workflows_blueprint.api_patch_tool', entity_id=tool.get('id')) }}`,
                type: "PATCH",
                contentType: "application/json",
                data: JSON.stringify({
                    outputs: { ...currentOutput, [newOutputName]: newOutput }
                }),
                success: function (response) {
                    currentOutput = response.result.outputs;
                    renderOutputs();
                    document.getElementById("new-output-name").value = '';
                    document.getElementById("new-output-name").classList.remove("is-valid", "is-invalid");
                    document.getElementById("new-output-description").value = '';
                    document.getElementById("new-output-format").value = 'csv';
                    $('#new-output-footer .stelar-loader').remove();
                    $('#new-output-footer').prepend(createAlertElement("success", "Output created successfully"));
                    setTimeout(function () {
                        $('#new-output-footer .alert').fadeOut(500, function () {
                            $(this).remove();
                        });
                    }, 3000);
                },
                error: function (error) {
                    $('#new-output-footer .stelar-loader').remove();
                    $('#new-output-footer').prepend(createAlertElement("danger", "Error creating output"));
                    setTimeout(function () {
                        $('#new-output-footer .alert').fadeOut(500, function () {
                            $(this).remove();
                        });
                    }, 3000);
                    console.error("Error creating output:", error);
                }
            });
        }

        function removeOutput(outputName) {
            confirmation = confirm("Are you sure you want to remove the output: " + outputName + "?");
            if (!confirmation) {
                return;
            }
            $.ajax({
                url: `{{ url_for('rest_workflows_blueprint.api_patch_tool', entity_id=tool.get('id')) }}`,
                type: "PATCH",
                contentType: "application/json",
                data: JSON.stringify({
                    outputs: Object.fromEntries(Object.entries(currentOutput).filter(([key]) => key !== outputName))
                }),
                success: function (response) {
                    currentOutput = response.result.outputs;
                    renderOutputs();
                },
                error: function (error) {
                    console.error("Error removing output:", error);
                }
            });
        }


        function validateNewParameter() {
            const newParameterName = document.getElementById("new-parameter-name");
            const newParameterValue = document.getElementById("new-parameter-value");
            const newParameterDescription = document.getElementById("new-parameter-description");
            const footerButton = document.getElementById("new-parameter-footer").querySelector("button");

            const parameterNameValue = newParameterName.value.trim();
            const parameterValueValue = newParameterValue.value.trim();
            const parameterDescriptionValue = newParameterDescription.value.trim();
            const isValidName = /^[a-zA-Z0-9_]+$/.test(parameterNameValue);

            if (parameterNameValue === "" || parameterValueValue === "" || parameterDescriptionValue === "") {
                newParameterName.classList.remove("is-valid", "is-invalid");
                footerButton.classList.add("disabled");
                return;
            }

            if (isValidName) {
                newParameterName.classList.add("is-valid");
                newParameterName.classList.remove("is-invalid");
                footerButton.classList.remove("disabled");
            } else {
                newParameterName.classList.add("is-invalid");
                newParameterName.classList.remove("is-valid");
                footerButton.classList.add("disabled");
            }
        }

        function attachNewParameterValidation() {
            const newParameterName = document.getElementById("new-parameter-name");
            newParameterName.addEventListener("input", validateNewParameter);
            newParameterName.addEventListener("blur", validateNewParameter);
            newParameterName.addEventListener("keyup", validateNewParameter);
            const newParameterValue = document.getElementById("new-parameter-value");
            newParameterValue.addEventListener("input", validateNewParameter);
            newParameterValue.addEventListener("blur", validateNewParameter);
            newParameterValue.addEventListener("keyup", validateNewParameter);
            const newParameterDescription = document.getElementById("new-parameter-description");
            newParameterDescription.addEventListener("input", validateNewParameter);
            newParameterDescription.addEventListener("blur", validateNewParameter);
            newParameterDescription.addEventListener("keyup", validateNewParameter);
        }

        function createNewParameter() {
            const newParameterName = document.getElementById("new-parameter-name").value.trim();
            let newParameterValue;
            try {
                newParameterValue = JSON.parse(document.getElementById("new-parameter-value").value.trim());
            } catch (e) {
                newParameterValue = document.getElementById("new-parameter-value").value.trim();
            }
            const newParameterDescription = document.getElementById("new-parameter-description").value.trim();
            const newParameterRequired = document.getElementById("new-parameter-required").checked;

            if (newParameterName === "" || newParameterValue === "" || newParameterDescription === "") {
                return;
            }

            $('#new-parameter-footer .stelar-loader').remove();
            $('#new-parameter-footer .alert').remove();
            $('#new-parameter-footer').prepend(createLoaderElement(false, true));

            const newParameter = {
                value: newParameterValue,
                description: newParameterDescription,
                required: newParameterRequired
            };

            $.ajax({
                url: `{{ url_for('rest_workflows_blueprint.api_patch_tool', entity_id=tool.get('id')) }}`,
                type: "PATCH",
                contentType: "application/json",
                data: JSON.stringify({
                    parameters: { ...currentParameters, [newParameterName]: newParameter }
                }),
                success: function (response) {
                    currentParameters = response.result.parameters;
                    renderParameters();
                    document.getElementById("new-parameter-name").value = '';
                    document.getElementById("new-parameter-name").classList.remove("is-valid", "is-invalid");
                    document.getElementById("new-parameter-value").value = '';
                    document.getElementById("new-parameter-description").value = '';
                    document.getElementById("new-parameter-required").checked = false;
                    $('#new-parameter-footer .stelar-loader').remove();
                    $('#new-parameter-footer').prepend(createAlertElement("success", "Parameter created successfully"));
                    setTimeout(function () {
                        $('#new-parameter-footer .alert').fadeOut(500, function () {
                            $(this).remove();
                        });
                    }, 3000);
                },
                error: function (error) {
                    $('#new-parameter-footer .stelar-loader').remove();
                    $('#new-parameter-footer').prepend(createAlertElement("danger", "Error creating parameter"));
                    setTimeout(function () {
                        $('#new-parameter-footer .alert').fadeOut(500, function () {
                            $(this).remove();
                        });
                    }, 3000);
                    console.error("Error creating parameter:", error);
                }
            });
        }


        function renderParameters() {
            const parametersList = $("#parameters-list");
            parametersList.empty(); // Clear existing content

            if (Object.keys(currentParameters).length === 0) {
                parametersList.append("<tr><td colspan='5' class='text-center text-secondary'>No parameters defined for this tool.</td></tr>");
                return;
            }

            Object.keys(currentParameters).forEach(paramName => {
                const param = currentParameters[paramName];
                const paramElement = `
                    <tr id="parameter-${paramName}" class="parameter-item">
                        <td class="text-center p-2">
                            <code>${paramName}</code>
                        </td>
                        <td class="p-2">
                            <span class="text-secondary">
                                ${typeof param.value === 'object' && param.value !== null
                        ? `<pre style="text-align: left; white-space: pre-wrap;">${JSON.stringify(param.value, null, 2)}</pre>`
                        : (param.value || '')}
                            </span>
                        </td>
                        <td class="text-center p-2">
                            <span class="text-secondary">${param.description || ''}</span>
                        </td>
                        <td class="text-center p-2">
                            ${param.required ? '<span class="badge bg-success-lt">Yes</span>' : '<span class="badge bg-secondary-lt">No</span>'}
                        </td>
                        <td class="text-center p-2">
                            <a class="text-link text-danger cursor-pointer" onclick="removeParameter('${paramName}')">Remove</a>
                        </td>
                    </tr>
                `;
                parametersList.append(paramElement);
            });
        }


        function removeParameter(paramName) {
            confirmation = confirm("Are you sure you want to remove the parameter: " + paramName + "?");
            if (!confirmation) {
                return;
            }
            $.ajax({
                url: `{{ url_for('rest_workflows_blueprint.api_patch_tool', entity_id=tool.get('id')) }}`,
                type: "PATCH",
                contentType: "application/json",
                data: JSON.stringify({
                    parameters: Object.fromEntries(Object.entries(currentParameters).filter(([key]) => key !== paramName))
                }),
                success: function (response) {
                    currentParameters = response.result.parameters;
                    renderParameters();
                },
                error: function (error) {
                    console.error("Error removing parameter:", error);
                }
            });
        }




        $(document).ready(function () {
            renderInputs();
            renderOutputs();
            renderParameters();
            attachNewInputValidation();
            attachNewOutputValidation();
            attachNewParameterValidation();
            fetchAvailableLicenses();
        });
    </script>



</body>